"use strict";(globalThis.webpackChunkdocusaurus_poc=globalThis.webpackChunkdocusaurus_poc||[]).push([[2733],{5122:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"tools/sonarqube","title":"\ud83d\udd0d SonarQube Community + Branch Plugin","description":"SonarQube Community avec le Community Branch Plugin permet l\'analyse de branches et la d\xe9coration de PR/MR, normalement r\xe9serv\xe9es \xe0 la version Developer.","source":"@site/docs/tools/sonarqube.md","sourceDirName":"tools","slug":"/tools/sonarqube","permalink":"/docs/tools/sonarqube","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/tools/sonarqube.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"docs","previous":{"title":"\ud83d\udd04 Renovate - Automatisation des d\xe9pendances","permalink":"/docs/tools/renovate"},"next":{"title":"Ecosystem","permalink":"/docs/ecosystem/"}}');var a=r(4848),o=r(8453);const i={sidebar_position:2},l="\ud83d\udd0d SonarQube Community + Branch Plugin",c={},t=[{value:"\ud83c\udfaf Pourquoi ce plugin ?",id:"-pourquoi-ce-plugin-",level:2},{value:"\ud83d\udce6 Installation",id:"-installation",level:2},{value:"Docker Compose (Recommand\xe9)",id:"docker-compose-recommand\xe9",level:3},{value:"Installation manuelle",id:"installation-manuelle",level:3},{value:"\u2699\ufe0f Configuration",id:"\ufe0f-configuration",level:2},{value:"1. Premi\xe8re connexion",id:"1-premi\xe8re-connexion",level:3},{value:"2. Cr\xe9er un projet",id:"2-cr\xe9er-un-projet",level:3},{value:"3. G\xe9n\xe9rer un token",id:"3-g\xe9n\xe9rer-un-token",level:3},{value:"4. Configuration GitLab/GitHub",id:"4-configuration-gitlabgithub",level:3},{value:"\ud83d\udd04 Int\xe9gration CI/CD",id:"-int\xe9gration-cicd",level:2},{value:"GitLab CI",id:"gitlab-ci",level:3},{value:"Jenkins",id:"jenkins",level:3},{value:"Ligne de commande",id:"ligne-de-commande",level:3},{value:"\ud83d\udcc1 Configuration g\xe9n\xe9rique",id:"-configuration-g\xe9n\xe9rique",level:2},{value:"Fichier sonar-project.properties",id:"fichier-sonar-projectproperties",level:3},{value:"Configuration par outil de build",id:"configuration-par-outil-de-build",level:3},{value:"Maven (Java)",id:"maven-java",level:4},{value:"Gradle (Java/Kotlin)",id:"gradle-javakotlin",level:4},{value:"Composer (PHP)",id:"composer-php",level:4},{value:"npm (JavaScript/TypeScript)",id:"npm-javascripttypescript",level:4},{value:"Autres langages",id:"autres-langages",level:4},{value:"Scan universel avec sonar-scanner",id:"scan-universel-avec-sonar-scanner",level:3},{value:"\ud83c\udfaf Configuration avanc\xe9e",id:"-configuration-avanc\xe9e",level:2},{value:"Quality Gate",id:"quality-gate",level:3},{value:"Quality Profile",id:"quality-profile",level:3},{value:"Exclusions globales",id:"exclusions-globales",level:3},{value:"\ud83d\udd10 S\xe9curit\xe9",id:"-s\xe9curit\xe9",level:2},{value:"SSL/TLS",id:"ssltls",level:3},{value:"Authentification LDAP",id:"authentification-ldap",level:3},{value:"\ud83d\udcca Webhooks et int\xe9grations",id:"-webhooks-et-int\xe9grations",level:2},{value:"GitLab Webhook",id:"gitlab-webhook",level:3},{value:"Alertes email",id:"alertes-email",level:3},{value:"\ud83c\udd98 Troubleshooting",id:"-troubleshooting",level:2},{value:"Plugin non charg\xe9",id:"plugin-non-charg\xe9",level:3},{value:"Erreur de connexion DB",id:"erreur-de-connexion-db",level:3},{value:"Branch analysis ne fonctionne pas",id:"branch-analysis-ne-fonctionne-pas",level:3},{value:"MR decoration ne s&#39;affiche pas",id:"mr-decoration-ne-saffiche-pas",level:3},{value:"\ud83c\udfaf Meilleures pratiques",id:"-meilleures-pratiques",level:2},{value:"1. Scanner \xe0 chaque commit",id:"1-scanner-\xe0-chaque-commit",level:3},{value:"2. Quality Gate obligatoire",id:"2-quality-gate-obligatoire",level:3},{value:"3. Coverage minimale",id:"3-coverage-minimale",level:3},{value:"4. Exclure les fichiers g\xe9n\xe9r\xe9s",id:"4-exclure-les-fichiers-g\xe9n\xe9r\xe9s",level:3},{value:"5. Maintenance r\xe9guli\xe8re",id:"5-maintenance-r\xe9guli\xe8re",level:3},{value:"\ud83d\udcc8 M\xe9triques importantes",id:"-m\xe9triques-importantes",level:2},{value:"\ud83d\udd04 Mise \xe0 jour",id:"-mise-\xe0-jour",level:2},{value:"\ud83d\udcda Ressources",id:"-ressources",level:2}];function d(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"-sonarqube-community--branch-plugin",children:"\ud83d\udd0d SonarQube Community + Branch Plugin"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"SonarQube Community"})," avec le ",(0,a.jsx)(e.strong,{children:"Community Branch Plugin"})," permet l'analyse de branches et la d\xe9coration de PR/MR, normalement r\xe9serv\xe9es \xe0 la version Developer."]}),"\n",(0,a.jsx)(e.h2,{id:"-pourquoi-ce-plugin-",children:"\ud83c\udfaf Pourquoi ce plugin ?"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:["\u2705 ",(0,a.jsx)(e.strong,{children:"Branch analysis"})," : Scanner plusieurs branches (feature, develop, main)"]}),"\n",(0,a.jsxs)(e.li,{children:["\u2705 ",(0,a.jsx)(e.strong,{children:"PR/MR decoration"})," : Commentaires automatiques sur les PR/MR"]}),"\n",(0,a.jsxs)(e.li,{children:["\u2705 ",(0,a.jsx)(e.strong,{children:"Gratuit"})," : Alternative \xe0 SonarQube Developer Edition"]}),"\n",(0,a.jsxs)(e.li,{children:["\u2705 ",(0,a.jsx)(e.strong,{children:"Multi-plateforme"})," : GitLab, GitHub, Bitbucket, Azure DevOps"]}),"\n"]}),"\n",(0,a.jsx)(e.h2,{id:"-installation",children:"\ud83d\udce6 Installation"}),"\n",(0,a.jsx)(e.h3,{id:"docker-compose-recommand\xe9",children:"Docker Compose (Recommand\xe9)"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-yaml",children:"# docker-compose.yml\r\nversion: '3'\r\n\r\nservices:\r\n  sonarqube:\r\n    image: mc1arke/sonarqube-with-community-branch-plugin:latest\r\n    container_name: sonarqube\r\n    ports:\r\n      - \"9000:9000\"\r\n    environment:\r\n      - SONAR_JDBC_URL=jdbc:postgresql://db:5432/sonar\r\n      - SONAR_JDBC_USERNAME=sonar\r\n      - SONAR_JDBC_PASSWORD=sonar\r\n    volumes:\r\n      - sonarqube_data:/opt/sonarqube/data\r\n      - sonarqube_logs:/opt/sonarqube/logs\r\n      - sonarqube_extensions:/opt/sonarqube/extensions\r\n    depends_on:\r\n      - db\r\n  \r\n  db:\r\n    image: postgres:15-alpine\r\n    container_name: sonarqube-db\r\n    environment:\r\n      - POSTGRES_USER=sonar\r\n      - POSTGRES_PASSWORD=sonar\r\n      - POSTGRES_DB=sonar\r\n    volumes:\r\n      - postgresql_data:/var/lib/postgresql/data\r\n\r\nvolumes:\r\n  sonarqube_data:\r\n  sonarqube_logs:\r\n  sonarqube_extensions:\r\n  postgresql_data:\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# D\xe9marrage\r\ndocker-compose up -d\r\n\r\n# Acc\xe8s : http://localhost:9000\r\n# Login par d\xe9faut : admin / admin\n"})}),"\n",(0,a.jsx)(e.h3,{id:"installation-manuelle",children:"Installation manuelle"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# 1. T\xe9l\xe9charger SonarQube Community\r\nwget https://binaries.sonarsource.com/Distribution/sonarqube/sonarqube-10.3.0.82913.zip\r\nunzip sonarqube-10.3.0.82913.zip\r\n\r\n# 2. T\xe9l\xe9charger le plugin\r\nwget https://github.com/mc1arke/sonarqube-community-branch-plugin/releases/download/1.18.0/sonarqube-community-branch-plugin-1.18.0.jar\r\n\r\n# 3. Installer le plugin\r\ncp sonarqube-community-branch-plugin-1.18.0.jar sonarqube-10.3.0.82913/extensions/plugins/\r\n\r\n# 4. D\xe9marrer SonarQube\r\ncd sonarqube-10.3.0.82913/bin/linux-x86-64\r\n./sonar.sh start\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\ufe0f-configuration",children:"\u2699\ufe0f Configuration"}),"\n",(0,a.jsx)(e.h3,{id:"1-premi\xe8re-connexion",children:"1. Premi\xe8re connexion"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# URL : http://localhost:9000\r\n# Login : admin / admin\r\n# \u2192 Changer le mot de passe\n"})}),"\n",(0,a.jsx)(e.h3,{id:"2-cr\xe9er-un-projet",children:"2. Cr\xe9er un projet"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Administration"})," \u2192 ",(0,a.jsx)(e.strong,{children:"Projects"})," \u2192 ",(0,a.jsx)(e.strong,{children:"Create Project"})]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Project key"})," : ",(0,a.jsx)(e.code,{children:"my-project"})]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Display name"})," : ",(0,a.jsx)(e.code,{children:"My Project"})]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Main branch"})," : ",(0,a.jsx)(e.code,{children:"main"})]}),"\n"]}),"\n",(0,a.jsx)(e.h3,{id:"3-g\xe9n\xe9rer-un-token",children:"3. G\xe9n\xe9rer un token"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"My Account"})," \u2192 ",(0,a.jsx)(e.strong,{children:"Security"})," \u2192 ",(0,a.jsx)(e.strong,{children:"Generate Tokens"})]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Name"})," : ",(0,a.jsx)(e.code,{children:"gitlab-ci"})," ou ",(0,a.jsx)(e.code,{children:"github-actions"})]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Type"})," : Global Analysis Token"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Expires in"})," : No expiration"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Generate"})," \u2192 Copier le token"]}),"\n"]}),"\n",(0,a.jsx)(e.h3,{id:"4-configuration-gitlabgithub",children:"4. Configuration GitLab/GitHub"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"GitLab"})," :"]}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Administration"})," \u2192 ",(0,a.jsx)(e.strong,{children:"Configuration"})," \u2192 ",(0,a.jsx)(e.strong,{children:"ALM"})]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"GitLab"})," \u2192 ",(0,a.jsx)(e.strong,{children:"Create configuration"})]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Configuration name"})," : ",(0,a.jsx)(e.code,{children:"GitLab"})]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"GitLab URL"})," : ",(0,a.jsx)(e.code,{children:"https://gitlab.com"})]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Personal Access Token"})," : Token GitLab avec scope ",(0,a.jsx)(e.code,{children:"api"})]}),"\n"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"GitHub"})," :"]}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"Administration"})," \u2192 ",(0,a.jsx)(e.strong,{children:"Configuration"})," \u2192 ",(0,a.jsx)(e.strong,{children:"ALM"})]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"GitHub"})," \u2192 ",(0,a.jsx)(e.strong,{children:"Create configuration"})]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"GitHub App"})," : Cr\xe9er une GitHub App avec permissions"]}),"\n"]}),"\n",(0,a.jsx)(e.h2,{id:"-int\xe9gration-cicd",children:"\ud83d\udd04 Int\xe9gration CI/CD"}),"\n",(0,a.jsx)(e.h3,{id:"gitlab-ci",children:"GitLab CI"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-yaml",children:'# .gitlab-ci.yml\r\nstages:\r\n  - sonar\r\n\r\nvariables:\r\n  SONAR_HOST_URL: "http://sonarqube:9000"\r\n  SONAR_TOKEN: $SONAR_TOKEN\r\n  GIT_DEPTH: 0\r\n\r\nsonarqube-check:\r\n  stage: sonar\r\n  image: \r\n    name: sonarsource/sonar-scanner-cli:latest\r\n    entrypoint: [""]\r\n  script:\r\n    - sonar-scanner\r\n      -Dsonar.projectKey=my-project\r\n      -Dsonar.sources=.\r\n      -Dsonar.host.url=$SONAR_HOST_URL\r\n      -Dsonar.token=$SONAR_TOKEN\r\n      -Dsonar.branch.name=$CI_COMMIT_REF_NAME\r\n  only:\r\n    - branches\r\n    - merge_requests\r\n\r\nsonarqube-mr-decoration:\r\n  stage: sonar\r\n  image: \r\n    name: sonarsource/sonar-scanner-cli:latest\r\n    entrypoint: [""]\r\n  script:\r\n    - sonar-scanner\r\n      -Dsonar.projectKey=my-project\r\n      -Dsonar.sources=.\r\n      -Dsonar.host.url=$SONAR_HOST_URL\r\n      -Dsonar.token=$SONAR_TOKEN\r\n      -Dsonar.pullrequest.key=$CI_MERGE_REQUEST_IID\r\n      -Dsonar.pullrequest.branch=$CI_MERGE_REQUEST_SOURCE_BRANCH_NAME\r\n      -Dsonar.pullrequest.base=$CI_MERGE_REQUEST_TARGET_BRANCH_NAME\r\n      -Dsonar.pullrequest.gitlab.projectId=$CI_PROJECT_PATH\r\n  only:\r\n    - merge_requests\n'})}),"\n",(0,a.jsx)(e.h3,{id:"jenkins",children:"Jenkins"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-groovy",children:"pipeline {\r\n    agent any\r\n    \r\n    environment {\r\n        SONAR_HOST = 'http://sonarqube:9000'\r\n        SONAR_TOKEN = credentials('sonar-token')\r\n    }\r\n    \r\n    stages {\r\n        stage('SonarQube Analysis') {\r\n            steps {\r\n                script {\r\n                    def scannerHome = tool 'SonarScanner'\r\n                    withSonarQubeEnv('SonarQube') {\r\n                        sh \"\"\"\r\n                            ${scannerHome}/bin/sonar-scanner \\\r\n                              -Dsonar.projectKey=my-project \\\r\n                              -Dsonar.sources=. \\\r\n                              -Dsonar.host.url=${SONAR_HOST} \\\r\n                              -Dsonar.token=${SONAR_TOKEN} \\\r\n                              -Dsonar.branch.name=${env.BRANCH_NAME}\r\n                        \"\"\"\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,a.jsx)(e.h3,{id:"ligne-de-commande",children:"Ligne de commande"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# Scan basique\r\nsonar-scanner \\\r\n  -Dsonar.projectKey=my-project \\\r\n  -Dsonar.sources=. \\\r\n  -Dsonar.host.url=http://localhost:9000 \\\r\n  -Dsonar.token=$SONAR_TOKEN\r\n\r\n# Avec branch\r\nsonar-scanner \\\r\n  -Dsonar.projectKey=my-project \\\r\n  -Dsonar.sources=. \\\r\n  -Dsonar.host.url=http://localhost:9000 \\\r\n  -Dsonar.token=$SONAR_TOKEN \\\r\n  -Dsonar.branch.name=feature/my-feature\n"})}),"\n",(0,a.jsx)(e.h2,{id:"-configuration-g\xe9n\xe9rique",children:"\ud83d\udcc1 Configuration g\xe9n\xe9rique"}),"\n",(0,a.jsx)(e.h3,{id:"fichier-sonar-projectproperties",children:"Fichier sonar-project.properties"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-properties",children:"# Configuration de base (tous langages)\r\nsonar.projectKey=my-project\r\nsonar.projectName=My Project\r\nsonar.projectVersion=1.0\r\n\r\n# Chemins sources\r\nsonar.sources=src\r\nsonar.tests=tests\r\n\r\n# Exclusions communes\r\nsonar.exclusions=\\\r\n  **/node_modules/**,\\\r\n  **/vendor/**,\\\r\n  **/dist/**,\\\r\n  **/build/**,\\\r\n  **/target/**,\\\r\n  **/*.min.js,\\\r\n  **/*.generated.*\r\n\r\nsonar.test.exclusions=\\\r\n  **/*Test.*,\\\r\n  **/*.spec.*,\\\r\n  **/test/**\n"})}),"\n",(0,a.jsx)(e.h3,{id:"configuration-par-outil-de-build",children:"Configuration par outil de build"}),"\n",(0,a.jsx)(e.h4,{id:"maven-java",children:"Maven (Java)"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-xml",children:"\x3c!-- pom.xml --\x3e\r\n<properties>\r\n    <sonar.projectKey>my-project</sonar.projectKey>\r\n    <sonar.host.url>http://localhost:9000</sonar.host.url>\r\n    <sonar.coverage.jacoco.xmlReportPaths>target/site/jacoco/jacoco.xml</sonar.coverage.jacoco.xmlReportPaths>\r\n</properties>\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"mvn clean verify sonar:sonar -Dsonar.token=$SONAR_TOKEN\n"})}),"\n",(0,a.jsx)(e.h4,{id:"gradle-javakotlin",children:"Gradle (Java/Kotlin)"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-groovy",children:'// build.gradle\r\nplugins {\r\n    id \'org.sonarqube\' version \'4.4.1.3373\'\r\n}\r\n\r\nsonar {\r\n    properties {\r\n        property "sonar.projectKey", "my-project"\r\n        property "sonar.host.url", "http://localhost:9000"\r\n    }\r\n}\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"./gradlew sonar -Dsonar.token=$SONAR_TOKEN\n"})}),"\n",(0,a.jsx)(e.h4,{id:"composer-php",children:"Composer (PHP)"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-properties",children:"# sonar-project.properties\r\nsonar.projectKey=my-project\r\nsonar.sources=src,modules\r\nsonar.tests=tests\r\nsonar.php.coverage.reportPaths=coverage.xml\r\nsonar.exclusions=vendor/**\n"})}),"\n",(0,a.jsx)(e.h4,{id:"npm-javascripttypescript",children:"npm (JavaScript/TypeScript)"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-properties",children:"# sonar-project.properties\r\nsonar.projectKey=my-project\r\nsonar.sources=src\r\nsonar.tests=tests\r\nsonar.javascript.lcov.reportPaths=coverage/lcov.info\r\nsonar.typescript.lcov.reportPaths=coverage/lcov.info\r\nsonar.exclusions=node_modules/**,dist/**\n"})}),"\n",(0,a.jsx)(e.h4,{id:"autres-langages",children:"Autres langages"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-properties",children:"# Python\r\nsonar.python.coverage.reportPaths=coverage.xml\r\n\r\n# Go\r\nsonar.go.coverage.reportPaths=coverage.out\r\n\r\n# .NET\r\nsonar.cs.vscoveragexml.reportsPaths=coverage.xml\r\n\r\n# Ruby\r\nsonar.ruby.coverage.reportPaths=coverage/coverage.xml\n"})}),"\n",(0,a.jsx)(e.h3,{id:"scan-universel-avec-sonar-scanner",children:"Scan universel avec sonar-scanner"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# Installation\r\n# Linux\r\nwget https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-5.0.1.3006-linux.zip\r\nunzip sonar-scanner-cli-5.0.1.3006-linux.zip\r\nexport PATH=$PATH:/path/to/sonar-scanner/bin\r\n\r\n# macOS\r\nbrew install sonar-scanner\r\n\r\n# Docker\r\ndocker run sonarsource/sonar-scanner-cli sonar-scanner [options]\r\n\r\n# Scan\r\nsonar-scanner -Dsonar.token=$SONAR_TOKEN\n"})}),"\n",(0,a.jsx)(e.h2,{id:"-configuration-avanc\xe9e",children:"\ud83c\udfaf Configuration avanc\xe9e"}),"\n",(0,a.jsx)(e.h3,{id:"quality-gate",children:"Quality Gate"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-yaml",children:"# Dans SonarQube UI\r\n# Quality Gates \u2192 Create \u2192 Configure:\r\n- Coverage > 80%\r\n- Duplicated Lines < 3%\r\n- Maintainability Rating = A\r\n- Reliability Rating = A\r\n- Security Rating = A\r\n- Security Hotspots Reviewed > 80%\n"})}),"\n",(0,a.jsx)(e.h3,{id:"quality-profile",children:"Quality Profile"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-yaml",children:"# Administration \u2192 Quality Profiles\r\n# Cr\xe9er un profil personnalis\xe9 par langage\r\n# Activer/d\xe9sactiver des r\xe8gles selon vos besoins\n"})}),"\n",(0,a.jsx)(e.h3,{id:"exclusions-globales",children:"Exclusions globales"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-properties",children:"# sonar-project.properties\r\nsonar.exclusions=\\\r\n  **/node_modules/**,\\\r\n  **/vendor/**,\\\r\n  **/dist/**,\\\r\n  **/build/**,\\\r\n  **/target/**,\\\r\n  **/*.min.js,\\\r\n  **/*.generated.*\r\n\r\nsonar.test.exclusions=\\\r\n  **/*Test.java,\\\r\n  **/*.spec.ts,\\\r\n  **/test/**\n"})}),"\n",(0,a.jsx)(e.h2,{id:"-s\xe9curit\xe9",children:"\ud83d\udd10 S\xe9curit\xe9"}),"\n",(0,a.jsx)(e.h3,{id:"ssltls",children:"SSL/TLS"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-yaml",children:"# docker-compose.yml\r\nservices:\r\n  sonarqube:\r\n    environment:\r\n      - SONAR_WEB_HTTPS_ENABLED=true\r\n      - SONAR_WEB_HTTPS_KEYSTORE_PATH=/opt/sonarqube/certs/keystore.p12\r\n      - SONAR_WEB_HTTPS_KEYSTORE_PASSWORD=changeit\r\n    volumes:\r\n      - ./certs:/opt/sonarqube/certs\n"})}),"\n",(0,a.jsx)(e.h3,{id:"authentification-ldap",children:"Authentification LDAP"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-properties",children:"# sonar.properties\r\nsonar.security.realm=LDAP\r\nldap.url=ldap://ldap.example.com:389\r\nldap.bindDn=cn=sonar,ou=users,dc=example,dc=com\r\nldap.bindPassword=secret\r\nldap.user.baseDn=ou=users,dc=example,dc=com\n"})}),"\n",(0,a.jsx)(e.h2,{id:"-webhooks-et-int\xe9grations",children:"\ud83d\udcca Webhooks et int\xe9grations"}),"\n",(0,a.jsx)(e.h3,{id:"gitlab-webhook",children:"GitLab Webhook"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-yaml",children:"# Administration \u2192 Configuration \u2192 Webhooks\r\n# URL: https://gitlab.com/api/v4/projects/{project_id}/statuses/{commit_sha}\r\n# Secret: Token GitLab\n"})}),"\n",(0,a.jsx)(e.h3,{id:"alertes-email",children:"Alertes email"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-yaml",children:"# Administration \u2192 Configuration \u2192 Email\r\nSMTP host: smtp.gmail.com\r\nSMTP port: 587\r\nSMTP username: your-email@gmail.com\r\nFrom address: sonarqube@example.com\n"})}),"\n",(0,a.jsx)(e.h2,{id:"-troubleshooting",children:"\ud83c\udd98 Troubleshooting"}),"\n",(0,a.jsx)(e.h3,{id:"plugin-non-charg\xe9",children:"Plugin non charg\xe9"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# V\xe9rifier les logs\r\ndocker logs sonarqube\r\n\r\n# V\xe9rifier le plugin\r\nls -la /opt/sonarqube/extensions/plugins/\r\n\r\n# Restart\r\ndocker-compose restart sonarqube\n"})}),"\n",(0,a.jsx)(e.h3,{id:"erreur-de-connexion-db",children:"Erreur de connexion DB"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# V\xe9rifier PostgreSQL\r\ndocker logs sonarqube-db\r\n\r\n# Recreate\r\ndocker-compose down -v\r\ndocker-compose up -d\n"})}),"\n",(0,a.jsx)(e.h3,{id:"branch-analysis-ne-fonctionne-pas",children:"Branch analysis ne fonctionne pas"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# V\xe9rifier la version du plugin\r\n# Plugin version >= 1.14.0 requis pour SonarQube 10.x\r\n\r\n# V\xe9rifier les param\xe8tres\r\n-Dsonar.branch.name=$CI_COMMIT_REF_NAME\n"})}),"\n",(0,a.jsx)(e.h3,{id:"mr-decoration-ne-saffiche-pas",children:"MR decoration ne s'affiche pas"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-yaml",children:"# V\xe9rifier la configuration ALM\r\n# Administration \u2192 Configuration \u2192 ALM \u2192 GitLab/GitHub\r\n\r\n# V\xe9rifier le token\r\n# Token doit avoir les permissions api/repo\n"})}),"\n",(0,a.jsx)(e.h2,{id:"-meilleures-pratiques",children:"\ud83c\udfaf Meilleures pratiques"}),"\n",(0,a.jsx)(e.h3,{id:"1-scanner-\xe0-chaque-commit",children:"1. Scanner \xe0 chaque commit"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-yaml",children:"on: [push, pull_request]\n"})}),"\n",(0,a.jsx)(e.h3,{id:"2-quality-gate-obligatoire",children:"2. Quality Gate obligatoire"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-yaml",children:"# Bloquer les MR si Quality Gate failed\r\nallow_failure: false\n"})}),"\n",(0,a.jsx)(e.h3,{id:"3-coverage-minimale",children:"3. Coverage minimale"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-properties",children:"sonar.coverage.minimum=80\n"})}),"\n",(0,a.jsx)(e.h3,{id:"4-exclure-les-fichiers-g\xe9n\xe9r\xe9s",children:"4. Exclure les fichiers g\xe9n\xe9r\xe9s"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-properties",children:"sonar.exclusions=**/*.generated.*,**/node_modules/**\n"})}),"\n",(0,a.jsx)(e.h3,{id:"5-maintenance-r\xe9guli\xe8re",children:"5. Maintenance r\xe9guli\xe8re"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# Backup DB hebdomadaire\r\n# Nettoyage des anciennes analyses (> 90 jours)\r\n# Mise \xe0 jour du plugin\n"})}),"\n",(0,a.jsx)(e.h2,{id:"-m\xe9triques-importantes",children:"\ud83d\udcc8 M\xe9triques importantes"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-yaml",children:"# \xc0 surveiller dans SonarQube\r\n- Code Coverage: > 80%\r\n- Duplicated Lines: < 3%\r\n- Technical Debt: < 5 days\r\n- Security Hotspots: 0\r\n- Bugs: 0\r\n- Vulnerabilities: 0\r\n- Code Smells: < 10\n"})}),"\n",(0,a.jsx)(e.h2,{id:"-mise-\xe0-jour",children:"\ud83d\udd04 Mise \xe0 jour"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# 1. Backup\r\ndocker-compose exec db pg_dump -U sonar sonar > backup.sql\r\n\r\n# 2. Arr\xeat\r\ndocker-compose down\r\n\r\n# 3. Mise \xe0 jour\r\ndocker-compose pull\r\n\r\n# 4. Red\xe9marrage\r\ndocker-compose up -d\n"})}),"\n",(0,a.jsx)(e.h2,{id:"-ressources",children:"\ud83d\udcda Ressources"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.a,{href:"https://github.com/mc1arke/sonarqube-community-branch-plugin",children:"SonarQube Community Branch Plugin"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.a,{href:"https://docs.sonarqube.org/",children:"SonarQube Documentation"})}),"\n",(0,a.jsx)(e.li,{children:(0,a.jsx)(e.a,{href:"https://docs.sonarqube.org/latest/analyzing-source-code/scanners/sonarscanner/",children:"SonarScanner CLI"})}),"\n"]}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"SonarQube analyse maintenant vos branches et d\xe9core vos MR/PR automatiquement !"})," \ud83d\udd0d\u2728"]})]})}function u(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(d,{...n})}):d(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>i,x:()=>l});var s=r(6540);const a={},o=s.createContext(a);function i(n){const e=s.useContext(o);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:i(n.components),s.createElement(o.Provider,{value:e},n.children)}}}]);