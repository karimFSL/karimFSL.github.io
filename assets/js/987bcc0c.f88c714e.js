"use strict";(globalThis.webpackChunkdocusaurus_poc=globalThis.webpackChunkdocusaurus_poc||[]).push([[3790],{6617:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"security/owasp/owasp-top-10","title":"OWASP Top 10","description":"Introduction","source":"@site/docs/security/owasp/owasp-top-10.md","sourceDirName":"security/owasp","slug":"/security/owasp/owasp-top-10","permalink":"/docs/security/owasp/owasp-top-10","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/security/owasp/owasp-top-10.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"TOP 10 OWASP","permalink":"/docs/security/owasp/"},"next":{"title":"Software Composition Analysis","permalink":"/docs/security/software-composition-analysis/"}}');var s=r(4848),t=r(8453);const a={},l="OWASP Top 10",o={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Vue d&#39;ensemble",id:"vue-densemble",level:2},{value:"A01 - Broken Access Control",id:"a01---broken-access-control",level:2},{value:"Probl\xe8me",id:"probl\xe8me",level:3},{value:"O\xf9 s\xe9curiser ?",id:"o\xf9-s\xe9curiser-",level:3},{value:"\ud83d\udd34 Applicatif (Prioritaire)",id:"-applicatif-prioritaire",level:4},{value:"\ud83d\udfe0 Infra",id:"-infra",level:4},{value:"\ud83d\udfe1 DevOps",id:"-devops",level:4},{value:"A02 - Cryptographic Failures",id:"a02---cryptographic-failures",level:2},{value:"Probl\xe8me",id:"probl\xe8me-1",level:3},{value:"O\xf9 s\xe9curiser ?",id:"o\xf9-s\xe9curiser--1",level:3},{value:"\ud83d\udd34 Infra (Prioritaire)",id:"-infra-prioritaire",level:4},{value:"\ud83d\udd34 Applicatif",id:"-applicatif",level:4},{value:"\ud83d\udfe0 DevOps",id:"-devops-1",level:4},{value:"A03 - Injection",id:"a03---injection",level:2},{value:"Probl\xe8me",id:"probl\xe8me-2",level:3},{value:"O\xf9 s\xe9curiser ?",id:"o\xf9-s\xe9curiser--2",level:3},{value:"\ud83d\udd34 Applicatif (Prioritaire)",id:"-applicatif-prioritaire-1",level:4},{value:"\ud83d\udfe0 Infra",id:"-infra-1",level:4},{value:"\ud83d\udfe1 DevOps",id:"-devops-2",level:4},{value:"A04 - Insecure Design",id:"a04---insecure-design",level:2},{value:"Probl\xe8me",id:"probl\xe8me-3",level:3},{value:"O\xf9 s\xe9curiser ?",id:"o\xf9-s\xe9curiser--3",level:3},{value:"\ud83d\udd34 Applicatif (Prioritaire)",id:"-applicatif-prioritaire-2",level:4},{value:"\ud83d\udfe0 DevOps",id:"-devops-3",level:4},{value:"A05 - Security Misconfiguration",id:"a05---security-misconfiguration",level:2},{value:"Probl\xe8me",id:"probl\xe8me-4",level:3},{value:"O\xf9 s\xe9curiser ?",id:"o\xf9-s\xe9curiser--4",level:3},{value:"\ud83d\udd34 Infra (Prioritaire)",id:"-infra-prioritaire-1",level:4},{value:"\ud83d\udfe0 Applicatif",id:"-applicatif-1",level:4},{value:"\ud83d\udd34 DevOps (Prioritaire)",id:"-devops-prioritaire",level:4},{value:"A06 - Vulnerable Components",id:"a06---vulnerable-components",level:2},{value:"Probl\xe8me",id:"probl\xe8me-5",level:3},{value:"O\xf9 s\xe9curiser ?",id:"o\xf9-s\xe9curiser--5",level:3},{value:"\ud83d\udd34 DevOps (Prioritaire)",id:"-devops-prioritaire-1",level:4},{value:"\ud83d\udfe0 Infra",id:"-infra-2",level:4},{value:"A07 - Authentication Failures",id:"a07---authentication-failures",level:2},{value:"Probl\xe8me",id:"probl\xe8me-6",level:3},{value:"O\xf9 s\xe9curiser ?",id:"o\xf9-s\xe9curiser--6",level:3},{value:"\ud83d\udd34 Applicatif (Prioritaire)",id:"-applicatif-prioritaire-3",level:4},{value:"\ud83d\udfe0 Infra",id:"-infra-3",level:4},{value:"A08 - Software &amp; Data Integrity Failures",id:"a08---software--data-integrity-failures",level:2},{value:"Probl\xe8me",id:"probl\xe8me-7",level:3},{value:"O\xf9 s\xe9curiser ?",id:"o\xf9-s\xe9curiser--7",level:3},{value:"\ud83d\udd34 DevOps (Prioritaire)",id:"-devops-prioritaire-2",level:4},{value:"\ud83d\udfe0 Applicatif",id:"-applicatif-2",level:4},{value:"A09 - Security Logging Failures",id:"a09---security-logging-failures",level:2},{value:"Probl\xe8me",id:"probl\xe8me-8",level:3},{value:"O\xf9 s\xe9curiser ?",id:"o\xf9-s\xe9curiser--8",level:3},{value:"\ud83d\udd34 Infra (Prioritaire)",id:"-infra-prioritaire-2",level:4},{value:"\ud83d\udfe0 Applicatif",id:"-applicatif-3",level:4},{value:"A10 - Server-Side Request Forgery (SSRF)",id:"a10---server-side-request-forgery-ssrf",level:2},{value:"Probl\xe8me",id:"probl\xe8me-9",level:3},{value:"O\xf9 s\xe9curiser ?",id:"o\xf9-s\xe9curiser--9",level:3},{value:"\ud83d\udd34 Applicatif (Prioritaire)",id:"-applicatif-prioritaire-4",level:4},{value:"\ud83d\udfe0 Infra",id:"-infra-4",level:4},{value:"Bonnes Pratiques Suppl\xe9mentaires",id:"bonnes-pratiques-suppl\xe9mentaires",level:2},{value:"CORS (Cross-Origin Resource Sharing)",id:"cors-cross-origin-resource-sharing",level:3},{value:"Security Headers",id:"security-headers",level:3},{value:"Input Validation &amp; Sanitization",id:"input-validation--sanitization",level:3},{value:"API Rate Limiting",id:"api-rate-limiting",level:3},{value:"Secrets Management",id:"secrets-management",level:3},{value:"Container Security",id:"container-security",level:3},{value:"Network Security",id:"network-security",level:3},{value:"Backup &amp; Disaster Recovery",id:"backup--disaster-recovery",level:3},{value:"Compliance &amp; Audit",id:"compliance--audit",level:3},{value:"R\xe9capitulatif par Couche",id:"r\xe9capitulatif-par-couche",level:2},{value:"\ud83d\udd34 Applicatif (Priorit\xe9 Haute)",id:"-applicatif-priorit\xe9-haute",level:3},{value:"\ud83d\udd34 Infra (Priorit\xe9 Haute)",id:"-infra-priorit\xe9-haute",level:3},{value:"\ud83d\udd34 DevOps (Priorit\xe9 Haute)",id:"-devops-priorit\xe9-haute",level:3},{value:"Ressources",id:"ressources",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"owasp-top-10",children:"OWASP Top 10"})}),"\n",(0,s.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsx)(n.p,{children:"L'OWASP Top 10 est la liste des 10 risques de s\xe9curit\xe9 les plus critiques pour les applications web (version 2021)."}),"\n",(0,s.jsx)(n.h2,{id:"vue-densemble",children:"Vue d'ensemble"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Rang"}),(0,s.jsx)(n.th,{children:"Risque"}),(0,s.jsx)(n.th,{children:"Impact"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"A01"})}),(0,s.jsx)(n.td,{children:"Broken Access Control"}),(0,s.jsx)(n.td,{children:"\ud83d\udd34 Critique"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"A02"})}),(0,s.jsx)(n.td,{children:"Cryptographic Failures"}),(0,s.jsx)(n.td,{children:"\ud83d\udd34 Critique"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"A03"})}),(0,s.jsx)(n.td,{children:"Injection"}),(0,s.jsx)(n.td,{children:"\ud83d\udd34 Critique"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"A04"})}),(0,s.jsx)(n.td,{children:"Insecure Design"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe0 \xc9lev\xe9"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"A05"})}),(0,s.jsx)(n.td,{children:"Security Misconfiguration"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe0 \xc9lev\xe9"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"A06"})}),(0,s.jsx)(n.td,{children:"Vulnerable Components"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe0 \xc9lev\xe9"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"A07"})}),(0,s.jsx)(n.td,{children:"Authentication Failures"}),(0,s.jsx)(n.td,{children:"\ud83d\udd34 Critique"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"A08"})}),(0,s.jsx)(n.td,{children:"Software & Data Integrity"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe0 \xc9lev\xe9"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"A09"})}),(0,s.jsx)(n.td,{children:"Security Logging Failures"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe1 Moyen"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"A10"})}),(0,s.jsx)(n.td,{children:"Server-Side Request Forgery"}),(0,s.jsx)(n.td,{children:"\ud83d\udfe0 \xc9lev\xe9"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"a01---broken-access-control",children:"A01 - Broken Access Control"}),"\n",(0,s.jsx)(n.h3,{id:"probl\xe8me",children:"Probl\xe8me"}),"\n",(0,s.jsx)(n.p,{children:"Utilisateurs acc\xe9dant \xe0 des ressources non autoris\xe9es."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Exemples"})," : Modification d'ID dans l'URL, \xe9l\xe9vation de privil\xe8ges, bypass d'autorisations."]}),"\n",(0,s.jsx)(n.h3,{id:"o\xf9-s\xe9curiser-",children:"O\xf9 s\xe9curiser ?"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph LR\n    A[Client] --\x3e B[Load Balancer]\n    B --\x3e C[API Gateway]\n    C --\x3e D[Application]\n    D --\x3e E[Database]\n    \n    style C fill:#ff9999\n    style D fill:#ff0000,color:#fff"}),"\n",(0,s.jsx)(n.h4,{id:"-applicatif-prioritaire",children:"\ud83d\udd34 Applicatif (Prioritaire)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Boot"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u274c Mauvais\n@GetMapping("/users/{id}")\npublic User getUser(@PathVariable Long id) {\n    return userService.findById(id);\n}\n\n// \u2705 Bon\n@GetMapping("/users/{id}")\n@PreAuthorize("@userSecurity.canAccessUser(authentication, #id)")\npublic User getUser(@PathVariable Long id) {\n    return userService.findById(id);\n}\n\n// UserSecurity.java\n@Component\npublic class UserSecurity {\n    public boolean canAccessUser(Authentication auth, Long userId) {\n        User currentUser = (User) auth.getPrincipal();\n        return currentUser.getId().equals(userId) || currentUser.isAdmin();\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Angular"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Bon - Guard\n@Injectable()\nexport class AuthGuard implements CanActivate {\n  canActivate(route: ActivatedRouteSnapshot): boolean {\n    const userId = route.params['id'];\n    return this.authService.canAccess(userId);\n  }\n}\n\n// Route\n{ path: 'users/:id', component: UserComponent, canActivate: [AuthGuard] }\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Actions"})," :"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"@PreAuthorize"}),", ",(0,s.jsx)(n.code,{children:"@Secured"})," sur chaque endpoint"]}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Guards Angular sur routes sensibles"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 V\xe9rifier ownership des ressources"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"-infra",children:"\ud83d\udfe0 Infra"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 WAF avec r\xe8gles anti-bypass"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 API Gateway avec authentification centralis\xe9e"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"-devops",children:"\ud83d\udfe1 DevOps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 Tests d'autorisation automatis\xe9s"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 SAST pour d\xe9tecter endpoints non prot\xe9g\xe9s"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"a02---cryptographic-failures",children:"A02 - Cryptographic Failures"}),"\n",(0,s.jsx)(n.h3,{id:"probl\xe8me-1",children:"Probl\xe8me"}),"\n",(0,s.jsx)(n.p,{children:"Donn\xe9es sensibles expos\xe9es (transmission en clair, stockage non chiffr\xe9, algorithmes faibles)."}),"\n",(0,s.jsx)(n.h3,{id:"o\xf9-s\xe9curiser--1",children:"O\xf9 s\xe9curiser ?"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph LR\n    A[Client] --\x3e|HTTPS| B[Load Balancer]\n    B --\x3e|TLS| C[Application]\n    C --\x3e|Encrypted| D[(Database)]\n    \n    style B fill:#ff0000,color:#fff\n    style C fill:#ff9999\n    style D fill:#ff9999"}),"\n",(0,s.jsx)(n.h4,{id:"-infra-prioritaire",children:"\ud83d\udd34 Infra (Prioritaire)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"HTTPS/TLS 1.3"})," partout"]}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Certificats valides (Let's Encrypt)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 HSTS activ\xe9"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Chiffrement des disques et backups"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"-applicatif",children:"\ud83d\udd34 Applicatif"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Boot"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"// \u2705 Bon - Hachage mot de passe\n@Configuration\npublic class SecurityConfig {\n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder(12);\n    }\n}\n\n// Service\npublic void createUser(String password) {\n    String hashed = passwordEncoder.encode(password);\n    user.setPassword(hashed);\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"application.yml"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# \u2705 Bon - Pas de secrets en dur\nspring:\n  datasource:\n    password: ${DB_PASSWORD}  # Variable d'environnement\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Actions"})," :"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 BCrypt/Argon2 pour mots de passe"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Pas de secrets dans le code"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Chiffrement AES-256 pour donn\xe9es sensibles"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"-devops-1",children:"\ud83d\udfe0 DevOps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 Vault (HashiCorp, AWS Secrets Manager)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Scan de secrets (git-secrets, truffleHog)"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"a03---injection",children:"A03 - Injection"}),"\n",(0,s.jsx)(n.h3,{id:"probl\xe8me-2",children:"Probl\xe8me"}),"\n",(0,s.jsx)(n.p,{children:"Injection SQL, NoSQL, OS commands, LDAP."}),"\n",(0,s.jsx)(n.h3,{id:"o\xf9-s\xe9curiser--2",children:"O\xf9 s\xe9curiser ?"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph LR\n    A[User Input] --\x3e B[Validation]\n    B --\x3e C[Application]\n    C --\x3e D[Prepared Statements]\n    D --\x3e E[(Database)]\n    \n    style B fill:#ff9999\n    style C fill:#ff0000,color:#fff\n    style D fill:#ff0000,color:#fff"}),"\n",(0,s.jsx)(n.h4,{id:"-applicatif-prioritaire-1",children:"\ud83d\udd34 Applicatif (Prioritaire)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Boot"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u274c Mauvais - SQL Injection\nString query = "SELECT * FROM users WHERE username = \'" + username + "\'";\njdbcTemplate.query(query, ...);\n\n// \u2705 Bon - Prepared Statement\n@Query("SELECT u FROM User u WHERE u.username = :username")\nUser findByUsername(@Param("username") String username);\n\n// \u2705 Bon - JPA Repository\npublic interface UserRepository extends JpaRepository<User, Long> {\n    Optional<User> findByUsername(String username);\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Validation"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u2705 Bon - Validation\n@RestController\npublic class UserController {\n    @PostMapping("/users")\n    public User create(@Valid @RequestBody UserDto userDto) {\n        return userService.create(userDto);\n    }\n}\n\n@Data\npublic class UserDto {\n    @NotBlank\n    @Pattern(regexp = "^[a-zA-Z0-9_-]{3,20}$")\n    private String username;\n    \n    @Email\n    private String email;\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Angular"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Bon - Validation c\xf4t\xe9 client\nthis.userForm = this.fb.group({\n  username: ['', [Validators.required, Validators.pattern('^[a-zA-Z0-9_-]{3,20}$')]],\n  email: ['', [Validators.required, Validators.email]]\n});\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Actions"})," :"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 JPA/Hibernate (ORM)"}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.code,{children:"@Valid"})," + Bean Validation"]}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Whitelist sur inputs"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"-infra-1",children:"\ud83d\udfe0 Infra"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 WAF avec r\xe8gles anti-injection"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Comptes DB avec permissions minimales"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"-devops-2",children:"\ud83d\udfe1 DevOps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 SAST pour d\xe9tecter injections"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"a04---insecure-design",children:"A04 - Insecure Design"}),"\n",(0,s.jsx)(n.h3,{id:"probl\xe8me-3",children:"Probl\xe8me"}),"\n",(0,s.jsx)(n.p,{children:"Failles de conception (pas de threat modeling, pas de rate limiting)."}),"\n",(0,s.jsx)(n.h3,{id:"o\xf9-s\xe9curiser--3",children:"O\xf9 s\xe9curiser ?"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph TD\n    A[Requirements] --\x3e B[Threat Modeling]\n    B --\x3e C[Secure Design]\n    C --\x3e D[Implementation]\n    \n    style B fill:#ff0000,color:#fff\n    style C fill:#ff0000,color:#fff"}),"\n",(0,s.jsx)(n.h4,{id:"-applicatif-prioritaire-2",children:"\ud83d\udd34 Applicatif (Prioritaire)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Boot - Rate Limiting"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u2705 Bon - Bucket4j\n@RestController\npublic class AuthController {\n    private final Bucket bucket = Bucket.builder()\n        .addLimit(Limit.of(5, Duration.ofMinutes(1)))\n        .build();\n    \n    @PostMapping("/login")\n    public ResponseEntity<?> login(@RequestBody LoginDto dto) {\n        if (!bucket.tryConsume(1)) {\n            return ResponseEntity.status(429).body("Too many requests");\n        }\n        // Login logic\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Actions"})," :"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 Threat modeling (STRIDE)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Rate limiting sur endpoints sensibles"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Validation m\xe9tier stricte"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"-devops-3",children:"\ud83d\udfe0 DevOps"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 Security champions"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Design reviews"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"a05---security-misconfiguration",children:"A05 - Security Misconfiguration"}),"\n",(0,s.jsx)(n.h3,{id:"probl\xe8me-4",children:"Probl\xe8me"}),"\n",(0,s.jsx)(n.p,{children:"Configuration par d\xe9faut, services inutiles, erreurs d\xe9taill\xe9es en prod."}),"\n",(0,s.jsx)(n.h3,{id:"o\xf9-s\xe9curiser--4",children:"O\xf9 s\xe9curiser ?"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph TD\n    A[Code] --\x3e B[Build]\n    B --\x3e C[Container]\n    C --\x3e D[Deploy]\n    \n    style C fill:#ff0000,color:#fff\n    style D fill:#ff0000,color:#fff"}),"\n",(0,s.jsx)(n.h4,{id:"-infra-prioritaire-1",children:"\ud83d\udd34 Infra (Prioritaire)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Dockerfile"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'# \u2705 Bon\nFROM eclipse-temurin:17-jre-alpine\nRUN addgroup -g 1001 spring && adduser -u 1001 -G spring -s /bin/sh -D spring\nUSER spring:spring\nWORKDIR /app\nCOPY --chown=spring:spring target/*.jar app.jar\nEXPOSE 8080\nENTRYPOINT ["java", "-jar", "app.jar"]\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Nginx"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:'# \u2705 Bon - Security headers\nadd_header X-Frame-Options "DENY";\nadd_header X-Content-Type-Options "nosniff";\nadd_header X-XSS-Protection "1; mode=block";\nadd_header Strict-Transport-Security "max-age=31536000";\nadd_header Content-Security-Policy "default-src \'self\'";\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Actions"})," :"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 Principe du moindre privil\xe8ge"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 D\xe9sactiver services inutiles"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Hardening OS (CIS Benchmarks)"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"-applicatif-1",children:"\ud83d\udfe0 Applicatif"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Boot"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# \u2705 Bon - application-prod.yml\nspring:\n  security:\n    headers:\n      frame-options: DENY\n      content-type-options: nosniff\n      xss-protection: 1; mode=block\nserver:\n  error:\n    include-message: never\n    include-stacktrace: never\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: health,metrics\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Angular"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Bon - ErrorHandler personnalis\xe9\n@Injectable()\nexport class GlobalErrorHandler implements ErrorHandler {\n  handleError(error: Error): void {\n    console.error('Error occurred:', error.message); // Log interne\n    this.notificationService.show('Une erreur est survenue'); // Message g\xe9n\xe9rique\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"-devops-prioritaire",children:"\ud83d\udd34 DevOps (Prioritaire)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 Infrastructure as Code (Terraform)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Scan de configuration (Checkov, TFSec)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Environnements identiques"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"a06---vulnerable-components",children:"A06 - Vulnerable Components"}),"\n",(0,s.jsx)(n.h3,{id:"probl\xe8me-5",children:"Probl\xe8me"}),"\n",(0,s.jsx)(n.p,{children:"D\xe9pendances vuln\xe9rables (Log4Shell, Spring4Shell, etc.)."}),"\n",(0,s.jsx)(n.h3,{id:"o\xf9-s\xe9curiser--5",children:"O\xf9 s\xe9curiser ?"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph LR\n    A[pom.xml] --\x3e B[Build]\n    B --\x3e C[Scan]\n    C --\x3e D[Container]\n    \n    style A fill:#ff9999\n    style C fill:#ff0000,color:#fff"}),"\n",(0,s.jsx)(n.h4,{id:"-devops-prioritaire-1",children:"\ud83d\udd34 DevOps (Prioritaire)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"SCA (Software Composition Analysis)"})," analyse les d\xe9pendances pour d\xe9tecter vuln\xe9rabilit\xe9s et licences."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"SBOM (Software Bill of Materials)"})," = Inventaire des composants logiciels."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Maven - OWASP Dependency Check + SBOM"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"\x3c!-- \u2705 Bon --\x3e\n<plugin>\n    <groupId>org.owasp</groupId>\n    <artifactId>dependency-check-maven</artifactId>\n    <version>9.0.0</version>\n    <configuration>\n        <failBuildOnCVSS>7</failBuildOnCVSS>\n    </configuration>\n</plugin>\n\n<plugin>\n    <groupId>org.cyclonedx</groupId>\n    <artifactId>cyclonedx-maven-plugin</artifactId>\n    <version>2.7.9</version>\n    <executions>\n        <execution>\n            <phase>package</phase>\n            <goals>\n                <goal>makeAggregateBom</goal>\n            </goals>\n        </execution>\n    </executions>\n</plugin>\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"GitLab CI - Pipeline s\xe9curit\xe9"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# .gitlab-ci.yml\n# \u2705 Bon\n\nstages:\n  - build\n  - security\n  - deploy\n\nvariables:\n  MAVEN_OPTS: "-Dmaven.repo.local=.m2/repository"\n\nbuild:\n  stage: build\n  image: maven:3.9-eclipse-temurin-17\n  script:\n    - mvn clean package\n    - mvn cyclonedx:makeAggregateBom\n  artifacts:\n    paths:\n      - target/*.jar\n      - target/bom.json\n    expire_in: 1 week\n\ndependency-check:\n  stage: security\n  image: maven:3.9-eclipse-temurin-17\n  script:\n    - mvn org.owasp:dependency-check-maven:check\n  artifacts:\n    reports:\n      dependency_scanning: target/dependency-check-report.json\n  allow_failure: false\n\ncontainer-scan:\n  stage: security\n  image: docker:latest\n  services:\n    - docker:dind\n  script:\n    - docker build -t $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA .\n    - docker run --rm -v /var/run/docker.sock:/var/run/docker.sock \n        aquasec/trivy image --severity HIGH,CRITICAL \n        --exit-code 1 $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA\n  dependencies:\n    - build\n\n# GitLab SAST int\xe9gr\xe9\ninclude:\n  - template: Security/SAST.gitlab-ci.yml\n  - template: Security/Dependency-Scanning.gitlab-ci.yml\n  - template: Security/Container-Scanning.gitlab-ci.yml\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Dependabot (GitLab Renovate)"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "extends": ["config:base"],\n  "packageRules": [\n    {\n      "matchUpdateTypes": ["minor", "patch"],\n      "automerge": true\n    },\n    {\n      "matchUpdateTypes": ["major"],\n      "labels": ["security", "dependencies"]\n    }\n  ]\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Outils SCA"})," :"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Outil"}),(0,s.jsx)(n.th,{children:"Usage"}),(0,s.jsx)(n.th,{children:"CI/CD"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"OWASP Dependency Check"})}),(0,s.jsx)(n.td,{children:"CVE detection"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"mvn check"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Trivy"})}),(0,s.jsx)(n.td,{children:"Container + FS scan"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"trivy image"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"GitLab Security"})}),(0,s.jsx)(n.td,{children:"Int\xe9gr\xe9"}),(0,s.jsx)(n.td,{children:"Templates"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Snyk"})}),(0,s.jsx)(n.td,{children:"Vulns + Fixes"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"snyk test"})})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Actions"})," :"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"SCA"})," dans pipeline GitLab CI"]}),"\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"SBOM"})," g\xe9n\xe9r\xe9 automatiquement"]}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Scan conteneurs avec Trivy"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Bloquer build si vulns critiques"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Renovate pour updates auto"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"-infra-2",children:"\ud83d\udfe0 Infra"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 Images de base minimales (Alpine)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Registry avec scan (Harbor)"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"a07---authentication-failures",children:"A07 - Authentication Failures"}),"\n",(0,s.jsx)(n.h3,{id:"probl\xe8me-6",children:"Probl\xe8me"}),"\n",(0,s.jsx)(n.p,{children:"Bruteforce, mots de passe faibles, pas de MFA."}),"\n",(0,s.jsx)(n.h3,{id:"o\xf9-s\xe9curiser--6",children:"O\xf9 s\xe9curiser ?"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph LR\n    A[User] --\x3e|Credentials| B[Auth]\n    B --\x3e|JWT| C[Application]\n    \n    style B fill:#ff0000,color:#fff"}),"\n",(0,s.jsx)(n.h4,{id:"-applicatif-prioritaire-3",children:"\ud83d\udd34 Applicatif (Prioritaire)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Security avec OIDC"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u2705 Bon - Configuration OIDC\n@Configuration\n@EnableWebSecurity\npublic class SecurityConfig {\n    \n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        return http\n            .csrf().csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse())\n            .and()\n            .authorizeHttpRequests(auth -> auth\n                .requestMatchers("/api/public/**").permitAll()\n                .anyRequest().authenticated()\n            )\n            .oauth2ResourceServer(oauth2 -> oauth2\n                .jwt(jwt -> jwt.jwtAuthenticationConverter(jwtAuthConverter()))\n            )\n            .oauth2Login(oauth2 -> oauth2\n                .defaultSuccessUrl("/dashboard")\n                .failureUrl("/login?error=true")\n            )\n            .logout(logout -> logout\n                .logoutSuccessUrl("/")\n                .invalidateHttpSession(true)\n                .deleteCookies("JSESSIONID")\n            )\n            .build();\n    }\n    \n    @Bean\n    public JwtAuthenticationConverter jwtAuthConverter() {\n        JwtAuthenticationConverter converter = new JwtAuthenticationConverter();\n        JwtGrantedAuthoritiesConverter authoritiesConverter = \n            new JwtGrantedAuthoritiesConverter();\n        authoritiesConverter.setAuthoritiesClaimName("roles");\n        authoritiesConverter.setAuthorityPrefix("ROLE_");\n        converter.setJwtGrantedAuthoritiesConverter(authoritiesConverter);\n        return converter;\n    }\n    \n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder(12);\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"application.yml - OIDC"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# \u2705 Bon - Configuration OIDC\nspring:\n  security:\n    oauth2:\n      client:\n        registration:\n          keycloak:\n            client-id: ${OIDC_CLIENT_ID}\n            client-secret: ${OIDC_CLIENT_SECRET}\n            scope: openid,profile,email\n            authorization-grant-type: authorization_code\n            redirect-uri: "{baseUrl}/login/oauth2/code/{registrationId}"\n        provider:\n          keycloak:\n            issuer-uri: https://auth.example.com/realms/myrealm\n            user-name-attribute: preferred_username\n      resourceserver:\n        jwt:\n          issuer-uri: https://auth.example.com/realms/myrealm\n          jwk-set-uri: https://auth.example.com/realms/myrealm/protocol/openid-connect/certs\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Contr\xf4leur avec OIDC"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u2705 Bon - Utilisation OIDC\n@RestController\n@RequestMapping("/api")\npublic class UserController {\n    \n    @GetMapping("/me")\n    public Map<String, Object> getCurrentUser(@AuthenticationPrincipal Jwt jwt) {\n        return Map.of(\n            "sub", jwt.getSubject(),\n            "email", jwt.getClaim("email"),\n            "name", jwt.getClaim("name"),\n            "roles", jwt.getClaim("roles")\n        );\n    }\n    \n    @GetMapping("/admin")\n    @PreAuthorize("hasRole(\'ADMIN\')")\n    public String adminEndpoint(@AuthenticationPrincipal Jwt jwt) {\n        return "Admin access granted for: " + jwt.getSubject();\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Angular - OIDC Client"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Bon - angular-oauth2-oidc\nimport { AuthConfig, OAuthService } from 'angular-oauth2-oidc';\n\nexport const authConfig: AuthConfig = {\n  issuer: 'https://auth.example.com/realms/myrealm',\n  clientId: 'angular-client',\n  redirectUri: window.location.origin + '/callback',\n  scope: 'openid profile email',\n  responseType: 'code',\n  showDebugInformation: false,\n  requireHttps: true\n};\n\n@Injectable()\nexport class AuthService {\n  constructor(private oauthService: OAuthService) {\n    this.configure();\n  }\n  \n  configure() {\n    this.oauthService.configure(authConfig);\n    this.oauthService.loadDiscoveryDocumentAndTryLogin();\n  }\n  \n  login() {\n    this.oauthService.initCodeFlow();\n  }\n  \n  logout() {\n    this.oauthService.logOut();\n  }\n  \n  getToken(): string {\n    return this.oauthService.getAccessToken();\n  }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Rate Limiting sur Login"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u2705 Bon - Bucket4j\n@Service\npublic class AuthService {\n    private final LoadingCache<String, Integer> attemptsCache = CacheBuilder.newBuilder()\n        .expireAfterWrite(5, TimeUnit.MINUTES)\n        .build(new CacheLoader<>() {\n            public Integer load(String key) { return 0; }\n        });\n    \n    public void loginFailed(String username) {\n        int attempts = attemptsCache.get(username);\n        attemptsCache.put(username, attempts + 1);\n        if (attempts >= 5) {\n            throw new AccountLockedException("Account locked");\n        }\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Angular - JWT Interceptor"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Bon\n@Injectable()\nexport class JwtInterceptor implements HttpInterceptor {\n  constructor(private authService: AuthService) {}\n  \n  intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n    const token = this.authService.getToken();\n    if (token) {\n      req = req.clone({\n        setHeaders: { Authorization: `Bearer ${token}` }\n      });\n    }\n    return next.handle(req).pipe(\n      catchError((error: HttpErrorResponse) => {\n        if (error.status === 401) {\n          this.authService.login();\n        }\n        return throwError(() => error);\n      })\n    );\n  }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Actions"})," :"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"OIDC/OAuth2"})," pour authentification"]}),"\n",(0,s.jsx)(n.li,{children:"\u2705 MFA au niveau IdP"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 JWT validation (signature, expiration)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Rate limiting (5 tentatives/5min)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Account lockout"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Session timeout"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Secure cookies (HttpOnly, Secure, SameSite)"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"-infra-3",children:"\ud83d\udfe0 Infra"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 WAF : protection bruteforce"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"a08---software--data-integrity-failures",children:"A08 - Software & Data Integrity Failures"}),"\n",(0,s.jsx)(n.h3,{id:"probl\xe8me-7",children:"Probl\xe8me"}),"\n",(0,s.jsx)(n.p,{children:"Pipeline compromis, CDN non v\xe9rifi\xe9, d\xe9s\xe9rialisation non s\xe9curis\xe9e."}),"\n",(0,s.jsx)(n.h3,{id:"o\xf9-s\xe9curiser--7",children:"O\xf9 s\xe9curiser ?"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph LR\n    A[Code] --\x3e|Signed| B[Build]\n    B --\x3e|Verified| C[Artifact]\n    C --\x3e D[Deploy]\n    \n    style B fill:#ff0000,color:#fff\n    style C fill:#ff0000,color:#fff"}),"\n",(0,s.jsx)(n.h4,{id:"-devops-prioritaire-2",children:"\ud83d\udd34 DevOps (Prioritaire)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Maven - Signature"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"\x3c!-- \u2705 Bon - GPG Plugin --\x3e\n<plugin>\n    <groupId>org.apache.maven.plugins</groupId>\n    <artifactId>maven-gpg-plugin</artifactId>\n    <executions>\n        <execution>\n            <goals><goal>sign</goal></goals>\n        </execution>\n    </executions>\n</plugin>\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Angular - SRI pour CDN"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'\x3c!-- \u2705 Bon --\x3e\n<script \n    src="https://cdn.example.com/lib.js"\n    integrity="sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K..."\n    crossorigin="anonymous">\n<\/script>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Actions"})," :"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 Signature des commits (GPG)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Signature des images Docker"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 SRI pour CDN"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Pipeline CI/CD s\xe9curis\xe9"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"-applicatif-2",children:"\ud83d\udfe0 Applicatif"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Boot - D\xe9s\xe9rialisation"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"// \u274c Mauvais\nObjectInputStream ois = new ObjectInputStream(input);\nObject obj = ois.readObject(); // Dangereux\n\n// \u2705 Bon - Utiliser JSON\nObjectMapper mapper = new ObjectMapper();\nUser user = mapper.readValue(json, User.class);\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"a09---security-logging-failures",children:"A09 - Security Logging Failures"}),"\n",(0,s.jsx)(n.h3,{id:"probl\xe8me-8",children:"Probl\xe8me"}),"\n",(0,s.jsx)(n.p,{children:"Logs insuffisants, pas de monitoring, pas d'alertes."}),"\n",(0,s.jsx)(n.h3,{id:"o\xf9-s\xe9curiser--8",children:"O\xf9 s\xe9curiser ?"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph LR\n    A[App] --\x3e|Logs| B[Centralized]\n    B --\x3e C[SIEM]\n    C --\x3e|Alerts| D[Team]\n    \n    style B fill:#ff0000,color:#fff\n    style C fill:#ff0000,color:#fff"}),"\n",(0,s.jsx)(n.h4,{id:"-infra-prioritaire-2",children:"\ud83d\udd34 Infra (Prioritaire)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 Logging centralis\xe9 (ELK, Splunk)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 SIEM avec alertes"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 R\xe9tention logs (compliance)"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"-applicatif-3",children:"\ud83d\udfe0 Applicatif"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Boot avec Actuator"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u2705 Bon - Logging s\xe9curit\xe9\n@Slf4j\n@RestController\npublic class AuthController {\n    private final MeterRegistry meterRegistry;\n    \n    @PostMapping("/login")\n    public ResponseEntity<?> login(@RequestBody LoginDto dto) {\n        try {\n            User user = authService.authenticate(dto);\n            log.info("Successful login for user: {}", user.getUsername());\n            meterRegistry.counter("auth.login.success").increment();\n            return ResponseEntity.ok(token);\n        } catch (BadCredentialsException e) {\n            log.warn("Failed login attempt for username: {}", dto.getUsername());\n            meterRegistry.counter("auth.login.failed").increment();\n            return ResponseEntity.status(401).build();\n        }\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"application.yml - Actuator + Prometheus"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# \u2705 Bon - Configuration compl\xe8te\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: health,metrics,prometheus,info\n      base-path: /actuator\n  endpoint:\n    health:\n      show-details: when-authorized\n  metrics:\n    export:\n      prometheus:\n        enabled: true\n    tags:\n      application: ${spring.application.name}\n      environment: ${spring.profiles.active}\n  \nspring:\n  application:\n    name: my-secure-app\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"pom.xml - D\xe9pendances"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"\x3c!-- Actuator + Prometheus --\x3e\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-actuator</artifactId>\n</dependency>\n<dependency>\n    <groupId>io.micrometer</groupId>\n    <artifactId>micrometer-registry-prometheus</artifactId>\n</dependency>\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Prometheus - prometheus.yml"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# \u2705 Bon - Scraping Spring Boot\nscrape_configs:\n  - job_name: 'spring-boot-app'\n    metrics_path: '/actuator/prometheus'\n    scrape_interval: 15s\n    static_configs:\n      - targets: ['app:8080']\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Grafana - Dashboard JSON"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "dashboard": {\n    "title": "Security Metrics",\n    "panels": [\n      {\n        "title": "Failed Login Attempts",\n        "targets": [\n          {\n            "expr": "rate(auth_login_failed_total[5m])"\n          }\n        ]\n      },\n      {\n        "title": "HTTP 4xx Errors",\n        "targets": [\n          {\n            "expr": "rate(http_server_requests_seconds_count{status=~\\"4..\\"}[5m])"\n          }\n        ]\n      }\n    ]\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"M\xe9triques personnalis\xe9es"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u2705 Bon - M\xe9triques m\xe9tier\n@Service\npublic class SecurityMetrics {\n    private final MeterRegistry registry;\n    \n    public void recordSuspiciousActivity(String type) {\n        registry.counter("security.suspicious.activity", "type", type).increment();\n    }\n    \n    public void recordAuthAttempt(boolean success) {\n        registry.counter("auth.attempts", \n            "result", success ? "success" : "failure").increment();\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"logback-spring.xml"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u2705 Bon - JSON pour parsing --\x3e\n<configuration>\n    <appender name="JSON" class="ch.qos.logback.core.rolling.RollingFileAppender">\n        <file>logs/app.log</file>\n        <encoder class="net.logstash.logback.encoder.LogstashEncoder">\n            <includeContext>true</includeContext>\n            <includeMdc>true</includeMdc>\n        </encoder>\n        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">\n            <fileNamePattern>logs/app-%d{yyyy-MM-dd}.log</fileNamePattern>\n            <maxHistory>30</maxHistory>\n        </rollingPolicy>\n    </appender>\n    \n    <logger name="com.example.security" level="INFO"/>\n    <root level="INFO">\n        <appender-ref ref="JSON"/>\n    </root>\n</configuration>\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Docker Compose - Stack compl\xe8te"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# \u2705 Bon - Monitoring stack\nversion: \'3.8\'\nservices:\n  app:\n    image: my-app:latest\n    ports:\n      - "8080:8080"\n    environment:\n      - SPRING_PROFILES_ACTIVE=prod\n  \n  prometheus:\n    image: prom/prometheus:latest\n    ports:\n      - "9090:9090"\n    volumes:\n      - ./prometheus.yml:/etc/prometheus/prometheus.yml\n  \n  grafana:\n    image: grafana/grafana:latest\n    ports:\n      - "3000:3000"\n    environment:\n      - GF_SECURITY_ADMIN_PASSWORD=admin123\n    volumes:\n      - grafana-storage:/var/lib/grafana\n  \n  loki:\n    image: grafana/loki:latest\n    ports:\n      - "3100:3100"\n  \n  promtail:\n    image: grafana/promtail:latest\n    volumes:\n      - ./logs:/var/log/app\n      - ./promtail-config.yml:/etc/promtail/config.yml\n\nvolumes:\n  grafana-storage:\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Actions"})," :"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 Logger \xe9v\xe9nements de s\xe9curit\xe9"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Actuator + Prometheus metrics"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Grafana dashboards pour alertes"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Correlation IDs (MDC)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Pas de donn\xe9es sensibles dans logs"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"a10---server-side-request-forgery-ssrf",children:"A10 - Server-Side Request Forgery (SSRF)"}),"\n",(0,s.jsx)(n.h3,{id:"probl\xe8me-9",children:"Probl\xe8me"}),"\n",(0,s.jsx)(n.p,{children:"Attaquant force le serveur \xe0 faire des requ\xeates vers destinations malveillantes."}),"\n",(0,s.jsx)(n.h3,{id:"o\xf9-s\xe9curiser--9",children:"O\xf9 s\xe9curiser ?"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph LR\n    A[User Input] --\x3e|URL| B[Application]\n    B --\x3e|Request| C[Internal Network]\n    \n    style B fill:#ff0000,color:#fff"}),"\n",(0,s.jsx)(n.h4,{id:"-applicatif-prioritaire-4",children:"\ud83d\udd34 Applicatif (Prioritaire)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Boot"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u274c Mauvais\n@GetMapping("/fetch")\npublic String fetch(@RequestParam String url) {\n    RestTemplate restTemplate = new RestTemplate();\n    return restTemplate.getForObject(url, String.class); // SSRF\n}\n\n// \u2705 Bon - Whitelist\n@GetMapping("/fetch")\npublic String fetch(@RequestParam String url) {\n    List<String> allowedHosts = List.of("api.trusted.com", "cdn.trusted.com");\n    \n    URI uri = URI.create(url);\n    if (!allowedHosts.contains(uri.getHost())) {\n        throw new IllegalArgumentException("Host not allowed");\n    }\n    \n    // Bloquer IPs priv\xe9es\n    InetAddress addr = InetAddress.getByName(uri.getHost());\n    if (addr.isSiteLocalAddress() || addr.isLoopbackAddress()) {\n        throw new IllegalArgumentException("Private IP not allowed");\n    }\n    \n    RestTemplate restTemplate = new RestTemplate();\n    return restTemplate.getForObject(url, String.class);\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Actions"})," :"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 Whitelist des destinations autoris\xe9es"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Bloquer IPs priv\xe9es (127.0.0.1, 192.168.x.x, 10.x.x.x)"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Validation stricte des URLs"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"-infra-4",children:"\ud83d\udfe0 Infra"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u2705 Network segmentation"}),"\n",(0,s.jsx)(n.li,{children:"\u2705 Egress filtering"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"bonnes-pratiques-suppl\xe9mentaires",children:"Bonnes Pratiques Suppl\xe9mentaires"}),"\n",(0,s.jsx)(n.h3,{id:"cors-cross-origin-resource-sharing",children:"CORS (Cross-Origin Resource Sharing)"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Boot"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u2705 Bon - CORS restrictif\n@Configuration\npublic class CorsConfig implements WebMvcConfigurer {\n    \n    @Override\n    public void addCorsMappings(CorsRegistry registry) {\n        registry.addMapping("/api/**")\n            .allowedOrigins("https://app.example.com")\n            .allowedMethods("GET", "POST", "PUT", "DELETE")\n            .allowedHeaders("Authorization", "Content-Type")\n            .allowCredentials(true)\n            .maxAge(3600);\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Angular"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'// Configuration proxy pour dev\n// proxy.conf.json\n{\n  "/api": {\n    "target": "http://localhost:8080",\n    "secure": false,\n    "changeOrigin": true\n  }\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"security-headers",children:"Security Headers"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Security"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"// \u2705 Bon - Security headers complets\n@Bean\npublic SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n    return http\n        .headers(headers -> headers\n            .frameOptions().deny()\n            .xssProtection().and()\n            .contentTypeOptions().and()\n            .httpStrictTransportSecurity()\n                .includeSubDomains(true)\n                .maxAgeInSeconds(31536000)\n            .and()\n            .contentSecurityPolicy(\"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'\")\n            .and()\n            .referrerPolicy(ReferrerPolicyHeaderWriter.ReferrerPolicy.STRICT_ORIGIN_WHEN_CROSS_ORIGIN)\n            .and()\n            .permissionsPolicy(policy -> policy\n                .policy(\"geolocation=(self)\")\n                .policy(\"camera=()\")\n                .policy(\"microphone=()\")\n            )\n        )\n        .build();\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"input-validation--sanitization",children:"Input Validation & Sanitization"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Boot - Validation avanc\xe9e"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u2705 Bon - DTO avec validation compl\xe8te\n@Data\npublic class UserDto {\n    @NotBlank(message = "Username required")\n    @Size(min = 3, max = 20)\n    @Pattern(regexp = "^[a-zA-Z0-9_-]+$", message = "Invalid characters")\n    private String username;\n    \n    @Email(message = "Invalid email")\n    @NotBlank\n    private String email;\n    \n    @NotBlank\n    @Size(min = 12, message = "Password too short")\n    @Pattern(regexp = "^(?=.*[a-z])(?=.*[A-Z])(?=.*\\\\d)(?=.*[@$!%*?&])[A-Za-z\\\\d@$!%*?&]+$",\n             message = "Password must contain uppercase, lowercase, digit, and special char")\n    private String password;\n    \n    @Past(message = "Birth date must be in the past")\n    private LocalDate birthDate;\n    \n    @URL\n    private String website;\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Angular - Validation formulaire"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Bon\nexport class UserFormComponent {\n  userForm = this.fb.group({\n    username: ['', [\n      Validators.required,\n      Validators.minLength(3),\n      Validators.maxLength(20),\n      Validators.pattern(/^[a-zA-Z0-9_-]+$/)\n    ]],\n    email: ['', [Validators.required, Validators.email]],\n    password: ['', [\n      Validators.required,\n      Validators.minLength(12),\n      this.passwordStrengthValidator()\n    ]]\n  });\n  \n  passwordStrengthValidator(): ValidatorFn {\n    return (control: AbstractControl): ValidationErrors | null => {\n      const value = control.value;\n      if (!value) return null;\n      \n      const hasUpperCase = /[A-Z]/.test(value);\n      const hasLowerCase = /[a-z]/.test(value);\n      const hasNumeric = /[0-9]/.test(value);\n      const hasSpecialChar = /[@$!%*?&]/.test(value);\n      \n      const valid = hasUpperCase && hasLowerCase && hasNumeric && hasSpecialChar;\n      return !valid ? { passwordStrength: true } : null;\n    };\n  }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Sanitization HTML"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"// \u2705 Bon - Angular\nimport { DomSanitizer, SafeHtml } from '@angular/platform-browser';\n\n@Component({...})\nexport class ArticleComponent {\n  constructor(private sanitizer: DomSanitizer) {}\n  \n  getSafeHtml(content: string): SafeHtml {\n    return this.sanitizer.sanitize(SecurityContext.HTML, content) || '';\n  }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"api-rate-limiting",children:"API Rate Limiting"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Boot - Bucket4j"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u2705 Bon - Rate limiting par IP\n@Component\npublic class RateLimitingFilter extends OncePerRequestFilter {\n    private final Map<String, Bucket> cache = new ConcurrentHashMap<>();\n    \n    @Override\n    protected void doFilterInternal(HttpServletRequest request, \n                                   HttpServletResponse response, \n                                   FilterChain filterChain) throws ServletException, IOException {\n        String ip = request.getRemoteAddr();\n        Bucket bucket = resolveBucket(ip);\n        \n        if (bucket.tryConsume(1)) {\n            filterChain.doFilter(request, response);\n        } else {\n            response.setStatus(429);\n            response.getWriter().write("Too many requests");\n        }\n    }\n    \n    private Bucket resolveBucket(String ip) {\n        return cache.computeIfAbsent(ip, k -> createNewBucket());\n    }\n    \n    private Bucket createNewBucket() {\n        return Bucket.builder()\n            .addLimit(Limit.of(100, Duration.ofMinutes(1)))\n            .build();\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Nginx - Rate limiting"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-nginx",children:"# \u2705 Bon\nhttp {\n    limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;\n    \n    server {\n        location /api/ {\n            limit_req zone=api burst=20 nodelay;\n            proxy_pass http://backend;\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"secrets-management",children:"Secrets Management"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Cloud Config + Vault"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# bootstrap.yml\n# \u2705 Bon\nspring:\n  cloud:\n    config:\n      uri: http://config-server:8888\n    vault:\n      host: vault.example.com\n      port: 8200\n      scheme: https\n      authentication: TOKEN\n      token: ${VAULT_TOKEN}\n      kv:\n        enabled: true\n        backend: secret\n        profile-separator: '/'\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"HashiCorp Vault"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# \u2705 Bon - Stockage secrets\nvault kv put secret/myapp/db \\\n  username=dbuser \\\n  password=supersecret\n\n# R\xe9cup\xe9ration\nvault kv get -field=password secret/myapp/db\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"container-security",children:"Container Security"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Dockerfile - Hardening complet"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'# \u2705 Bon - Multi-stage s\xe9curis\xe9\nFROM maven:3.9-eclipse-temurin-17-alpine AS build\nWORKDIR /build\nCOPY pom.xml .\nRUN mvn dependency:go-offline\nCOPY src ./src\nRUN mvn clean package -DskipTests && \\\n    mvn cyclonedx:makeAggregateBom\n\n# Scan de vuln\xe9rabilit\xe9s\nFROM aquasec/trivy:latest AS scan\nCOPY --from=build /build/target/*.jar /scan/app.jar\nRUN trivy rootfs --severity HIGH,CRITICAL --exit-code 1 /scan\n\n# Runtime\nFROM eclipse-temurin:17-jre-alpine AS runtime\n\n# Mises \xe0 jour s\xe9curit\xe9\nRUN apk update && apk upgrade && \\\n    apk add --no-cache dumb-init && \\\n    rm -rf /var/cache/apk/*\n\n# Utilisateur non-root\nRUN addgroup -g 1001 -S appuser && \\\n    adduser -u 1001 -S appuser -G appuser\n\n# R\xe9pertoire avec permissions restreintes\nWORKDIR /app\nRUN chown -R appuser:appuser /app\n\n# Copie avec ownership\nCOPY --from=build --chown=appuser:appuser /build/target/*.jar app.jar\nCOPY --from=build --chown=appuser:appuser /build/target/bom.json /sbom/\n\nUSER appuser\n\n# Port non-privil\xe9gi\xe9\nEXPOSE 8080\n\n# Health check\nHEALTHCHECK --interval=30s --timeout=3s --retries=3 \\\n  CMD wget --no-verbose --tries=1 --spider http://localhost:8080/actuator/health || exit 1\n\n# Init system pour PID 1\nENTRYPOINT ["dumb-init", "--"]\nCMD ["java", \\\n     "-XX:+UseContainerSupport", \\\n     "-XX:MaxRAMPercentage=75.0", \\\n     "-Djava.security.egd=file:/dev/./urandom", \\\n     "-jar", "app.jar"]\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Kubernetes - Security Context"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# \u2705 Bon - Pod s\xe9curis\xe9\napiVersion: v1\nkind: Pod\nmetadata:\n  name: secure-app\nspec:\n  securityContext:\n    runAsNonRoot: true\n    runAsUser: 1001\n    fsGroup: 1001\n    seccompProfile:\n      type: RuntimeDefault\n  \n  containers:\n  - name: app\n    image: myapp:latest\n    securityContext:\n      allowPrivilegeEscalation: false\n      readOnlyRootFilesystem: true\n      capabilities:\n        drop:\n        - ALL\n    \n    resources:\n      limits:\n        memory: "512Mi"\n        cpu: "500m"\n      requests:\n        memory: "256Mi"\n        cpu: "250m"\n    \n    livenessProbe:\n      httpGet:\n        path: /actuator/health/liveness\n        port: 8080\n      initialDelaySeconds: 30\n      periodSeconds: 10\n    \n    readinessProbe:\n      httpGet:\n        path: /actuator/health/readiness\n        port: 8080\n      initialDelaySeconds: 10\n      periodSeconds: 5\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"network-security",children:"Network Security"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Architecture Zero Trust"})," :"]}),"\n",(0,s.jsx)(n.mermaid,{value:"graph TB\n    subgraph Internet\n        U[User]\n    end\n    \n    subgraph DMZ\n        LB[Load Balancer]\n        WAF[WAF]\n    end\n    \n    subgraph App_Zone\n        API[API Gateway]\n        AUTH[Auth Service]\n        APP[Application]\n    end\n    \n    subgraph Data_Zone\n        DB[(Database)]\n        CACHE[(Redis)]\n    end\n    \n    U --\x3e|HTTPS| LB\n    LB --\x3e WAF\n    WAF --\x3e API\n    API --\x3e AUTH\n    AUTH --\x3e APP\n    APP --\x3e DB\n    APP --\x3e CACHE\n    \n    style WAF fill:#ff9999\n    style API fill:#ff9999\n    style AUTH fill:#ff0000,color:#fff\n    style APP fill:#ff9999\n    style DB fill:#ff9999"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Network Policies (Kubernetes)"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# \u2705 Bon - Isolation r\xe9seau\napiVersion: networking.k8s.io/v1\nkind: NetworkPolicy\nmetadata:\n  name: app-network-policy\nspec:\n  podSelector:\n    matchLabels:\n      app: myapp\n  policyTypes:\n  - Ingress\n  - Egress\n  \n  ingress:\n  - from:\n    - podSelector:\n        matchLabels:\n          app: api-gateway\n    ports:\n    - protocol: TCP\n      port: 8080\n  \n  egress:\n  - to:\n    - podSelector:\n        matchLabels:\n          app: database\n    ports:\n    - protocol: TCP\n      port: 5432\n  - to:\n    - podSelector:\n        matchLabels:\n          app: redis\n    ports:\n    - protocol: TCP\n      port: 6379\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"backup--disaster-recovery",children:"Backup & Disaster Recovery"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"PostgreSQL - Backup chiffr\xe9"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# \u2705 Bon - Backup automatis\xe9\n#!/bin/bash\nDATE=$(date +%Y%m%d_%H%M%S)\nBACKUP_DIR="/backups"\nDB_NAME="myapp"\n\n# Dump + Compression + Chiffrement\npg_dump $DB_NAME | \\\n  gzip | \\\n  openssl enc -aes-256-cbc -salt -pbkdf2 -pass file:/secrets/backup.key \\\n  > $BACKUP_DIR/backup_${DB_NAME}_${DATE}.sql.gz.enc\n\n# Upload vers S3 avec chiffrement c\xf4t\xe9 serveur\naws s3 cp $BACKUP_DIR/backup_${DB_NAME}_${DATE}.sql.gz.enc \\\n  s3://my-backups/ \\\n  --storage-class GLACIER \\\n  --server-side-encryption AES256\n\n# R\xe9tention: supprimer backups > 30 jours\nfind $BACKUP_DIR -name "*.enc" -mtime +30 -delete\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"compliance--audit",children:"Compliance & Audit"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Boot Actuator - Audit Events"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u2705 Bon - Audit des actions sensibles\n@Service\n@Slf4j\npublic class AuditService {\n    private final ApplicationEventPublisher publisher;\n    \n    public void auditLogin(String username, boolean success) {\n        AuditEvent event = new AuditEvent(\n            username,\n            success ? "LOGIN_SUCCESS" : "LOGIN_FAILURE",\n            Map.of(\n                "timestamp", Instant.now(),\n                "ip", getCurrentIP(),\n                "userAgent", getCurrentUserAgent()\n            )\n        );\n        publisher.publishEvent(new AuditApplicationEvent(event));\n        log.info("Audit: {} - {}", event.getType(), username);\n    }\n    \n    public void auditDataAccess(String username, String resource) {\n        AuditEvent event = new AuditEvent(\n            username,\n            "DATA_ACCESS",\n            Map.of("resource", resource)\n        );\n        publisher.publishEvent(new AuditApplicationEvent(event));\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"GDPR - Data retention"})," :"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u2705 Bon - Suppression automatique donn\xe9es\n@Scheduled(cron = "0 0 2 * * *") // 2h du matin\npublic void deleteExpiredData() {\n    LocalDateTime threshold = LocalDateTime.now().minusDays(90);\n    \n    // Logs > 90 jours\n    logRepository.deleteByCreatedAtBefore(threshold);\n    \n    // Donn\xe9es utilisateurs supprim\xe9s\n    userRepository.findByDeletedAtBefore(threshold.minusDays(30))\n        .forEach(user -> {\n            // Anonymisation\n            user.setEmail("deleted@example.com");\n            user.setName("Deleted User");\n            userRepository.save(user);\n        });\n}\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"r\xe9capitulatif-par-couche",children:"R\xe9capitulatif par Couche"}),"\n",(0,s.jsx)(n.h3,{id:"-applicatif-priorit\xe9-haute",children:"\ud83d\udd34 Applicatif (Priorit\xe9 Haute)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["A01: ",(0,s.jsx)(n.code,{children:"@PreAuthorize"}),", Guards"]}),"\n",(0,s.jsx)(n.li,{children:"A02: BCrypt, pas de secrets en dur"}),"\n",(0,s.jsxs)(n.li,{children:["A03: JPA, ",(0,s.jsx)(n.code,{children:"@Valid"})]}),"\n",(0,s.jsx)(n.li,{children:"A04: Rate limiting, validation m\xe9tier"}),"\n",(0,s.jsxs)(n.li,{children:["A07: ",(0,s.jsx)(n.strong,{children:"OIDC/OAuth2"}),", MFA, JWT"]}),"\n",(0,s.jsx)(n.li,{children:"A10: Whitelist URLs, bloquer IPs priv\xe9es"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Bonus"}),": CORS restrictif, Security headers, Input validation"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"-infra-priorit\xe9-haute",children:"\ud83d\udd34 Infra (Priorit\xe9 Haute)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"A02: HTTPS/TLS 1.3, HSTS"}),"\n",(0,s.jsx)(n.li,{children:"A05: Hardening, moindre privil\xe8ge"}),"\n",(0,s.jsxs)(n.li,{children:["A09: ",(0,s.jsx)(n.strong,{children:"Prometheus + Grafana + Loki"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Bonus"}),": WAF, Network segmentation, Backup chiffr\xe9"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"-devops-priorit\xe9-haute",children:"\ud83d\udd34 DevOps (Priorit\xe9 Haute)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"A05: IaC, scan configuration"}),"\n",(0,s.jsxs)(n.li,{children:["A06: ",(0,s.jsx)(n.strong,{children:"SCA + SBOM"})," (CycloneDX, Trivy, Snyk)"]}),"\n",(0,s.jsx)(n.li,{children:"A08: Signature commits/images"}),"\n",(0,s.jsxs)(n.li,{children:["A09: ",(0,s.jsx)(n.strong,{children:"Actuator + Metrics"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Bonus"}),": Secrets management (Vault), Container hardening"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"ressources",children:"Ressources"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://owasp.org/Top10/",children:"OWASP Top 10 2021"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.spring.io/spring-security/",children:"Spring Security Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://angular.io/guide/security",children:"Angular Security Guide"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://cyclonedx.org/",children:"CycloneDX SBOM"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://owasp.org/www-project-dependency-check/",children:"OWASP Dependency Check"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://aquasecurity.github.io/trivy/",children:"Trivy Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://prometheus.io/docs/",children:"Prometheus Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://grafana.com/docs/",children:"Grafana Documentation"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>l});var i=r(6540);const s={},t=i.createContext(s);function a(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);