"use strict";(globalThis.webpackChunkdocusaurus_poc=globalThis.webpackChunkdocusaurus_poc||[]).push([[26],{8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>c});var i=r(6540);const s={},t=i.createContext(s);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(t.Provider,{value:n},e.children)}},9948:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"microservices/infrastructure/service-mesh","title":"Service Mesh","description":"Concept","source":"@site/docs/microservices/infrastructure/service-mesh.md","sourceDirName":"microservices/infrastructure","slug":"/microservices/infrastructure/service-mesh","permalink":"/docs/microservices/infrastructure/service-mesh","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/microservices/infrastructure/service-mesh.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"docs","previous":{"title":"Service Discovery","permalink":"/docs/microservices/infrastructure/service-discovery"},"next":{"title":"Devops","permalink":"/docs/devops/"}}');var s=r(4848),t=r(8453);const l={sidebar_position:4},c="Service Mesh",a={},o=[{value:"Concept",id:"concept",level:2},{value:"\ud83c\udfaf Probl\xe8me r\xe9solu",id:"-probl\xe8me-r\xe9solu",level:2},{value:"Sans Service Mesh",id:"sans-service-mesh",level:3},{value:"Avec Service Mesh",id:"avec-service-mesh",level:3},{value:"\ud83c\udfd7\ufe0f Architecture",id:"\ufe0f-architecture",level:2},{value:"Pattern Sidecar",id:"pattern-sidecar",level:3},{value:"\ud83d\udd27 Principales solutions",id:"-principales-solutions",level:2},{value:"Istio",id:"istio",level:3},{value:"Linkerd",id:"linkerd",level:3},{value:"Consul Connect",id:"consul-connect",level:3},{value:"AWS App Mesh",id:"aws-app-mesh",level:3},{value:"\ud83d\ude80 Fonctionnalit\xe9s",id:"-fonctionnalit\xe9s",level:2},{value:"1. Traffic Management",id:"1-traffic-management",level:3},{value:"Load Balancing avanc\xe9",id:"load-balancing-avanc\xe9",level:4},{value:"Canary Deployment",id:"canary-deployment",level:4},{value:"Circuit Breaking",id:"circuit-breaking",level:4},{value:"2. Security",id:"2-security",level:3},{value:"mTLS automatique",id:"mtls-automatique",level:4},{value:"Authorization policies",id:"authorization-policies",level:4},{value:"3. Observability",id:"3-observability",level:3},{value:"Distributed Tracing",id:"distributed-tracing",level:4},{value:"M\xe9triques",id:"m\xe9triques",level:4},{value:"Service Graph",id:"service-graph",level:4},{value:"4. Resiliency",id:"4-resiliency",level:3},{value:"Retry automatique",id:"retry-automatique",level:4},{value:"Timeout",id:"timeout",level:4},{value:"Fault Injection (test de r\xe9silience)",id:"fault-injection-test-de-r\xe9silience",level:4},{value:"\ud83c\udfa8 Cas d&#39;usage",id:"-cas-dusage",level:2},{value:"1. Migration progressive vers microservices",id:"1-migration-progressive-vers-microservices",level:3},{value:"2. Multi-cluster",id:"2-multi-cluster",level:3},{value:"3. A/B Testing",id:"3-ab-testing",level:3},{value:"\ud83d\udcca Performance",id:"-performance",level:2},{value:"Overhead typique",id:"overhead-typique",level:3},{value:"\u26a0\ufe0f Consid\xe9rations",id:"\ufe0f-consid\xe9rations",level:2},{value:"Quand utiliser un Service Mesh ?",id:"quand-utiliser-un-service-mesh-",level:3},{value:"Complexit\xe9 op\xe9rationnelle",id:"complexit\xe9-op\xe9rationnelle",level:3},{value:"\u2705 Bonnes pratiques",id:"-bonnes-pratiques",level:2},{value:"\ud83e\uddea Migration progressive",id:"-migration-progressive",level:2},{value:"Phase 1 : Observability",id:"phase-1--observability",level:3},{value:"Phase 2 : Security",id:"phase-2--security",level:3},{value:"Phase 3 : Traffic Management",id:"phase-3--traffic-management",level:3},{value:"Phase 4 : Strict Mode",id:"phase-4--strict-mode",level:3},{value:"\ud83d\udcc8 M\xe9triques cl\xe9s",id:"-m\xe9triques-cl\xe9s",level:2},{value:"Ressources",id:"ressources",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"service-mesh",children:"Service Mesh"})}),"\n",(0,s.jsx)(n.h2,{id:"concept",children:"Concept"}),"\n",(0,s.jsxs)(n.p,{children:["Un ",(0,s.jsx)(n.strong,{children:"Service Mesh"})," est une couche d'infrastructure d\xe9di\xe9e qui g\xe8re la communication entre microservices. Il d\xe9charge les services de la logique de r\xe9seau, s\xe9curit\xe9 et observabilit\xe9."]}),"\n",(0,s.jsx)(n.admonition,{title:"Principe",type:"tip",children:(0,s.jsx)(n.p,{children:"Ajouter un proxy l\xe9ger (sidecar) \xe0 c\xf4t\xe9 de chaque instance de service pour intercepter et g\xe9rer tout le trafic r\xe9seau."})}),"\n",(0,s.jsx)(n.h2,{id:"-probl\xe8me-r\xe9solu",children:"\ud83c\udfaf Probl\xe8me r\xe9solu"}),"\n",(0,s.jsx)(n.h3,{id:"sans-service-mesh",children:"Sans Service Mesh"}),"\n",(0,s.jsx)(n.p,{children:"Chaque service doit impl\xe9menter :"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u274c Circuit breaker, retry, timeout"}),"\n",(0,s.jsx)(n.li,{children:"\u274c Load balancing"}),"\n",(0,s.jsx)(n.li,{children:"\u274c Service discovery"}),"\n",(0,s.jsx)(n.li,{children:"\u274c TLS mutuel"}),"\n",(0,s.jsx)(n.li,{children:"\u274c Distributed tracing"}),"\n",(0,s.jsx)(n.li,{children:"\u274c Metrics collection"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u2192 Code dupliqu\xe9, complexit\xe9, risques d'incoh\xe9rence"})}),"\n",(0,s.jsx)(n.h3,{id:"avec-service-mesh",children:"Avec Service Mesh"}),"\n",(0,s.jsxs)(n.p,{children:["\u2705 Logique de r\xe9seau ",(0,s.jsx)(n.strong,{children:"externalis\xe9e"})," dans l'infrastructure\r\n\u2705 Configuration ",(0,s.jsx)(n.strong,{children:"centralis\xe9e"}),"\r\n\u2705 Observabilit\xe9 ",(0,s.jsx)(n.strong,{children:"unifi\xe9e"})]}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-architecture",children:"\ud83c\udfd7\ufe0f Architecture"}),"\n",(0,s.jsx)(n.h3,{id:"pattern-sidecar",children:"Pattern Sidecar"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph LR\r\n    subgraph Pod A\r\n        A1[App A]\r\n        P1[Proxy]\r\n        A1 -.-> P1\r\n    end\r\n    \r\n    subgraph Pod B\r\n        A2[App B]\r\n        P2[Proxy]\r\n        P2 -.-> A2\r\n    end\r\n    \r\n    P1 --\x3e P2\r\n    \r\n    CP[Control Plane]\r\n    CP -.Config.-> P1\r\n    CP -.Config.-> P2"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Composants :"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Data Plane"})," : proxies sidecar (Envoy)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Control Plane"})," : configuration et orchestration"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"-principales-solutions",children:"\ud83d\udd27 Principales solutions"}),"\n",(0,s.jsx)(n.h3,{id:"istio",children:"Istio"}),"\n",(0,s.jsx)(n.p,{children:"Le plus complet et mature"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Avantages :"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Riche en fonctionnalit\xe9s"}),"\n",(0,s.jsx)(n.li,{children:"Support multi-cloud"}),"\n",(0,s.jsx)(n.li,{children:"Large communaut\xe9"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Inconv\xe9nients :"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Complexe \xe0 op\xe9rer"}),"\n",(0,s.jsx)(n.li,{children:"Overhead de ressources"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Exemple de configuration Istio\r\napiVersion: networking.istio.io/v1beta1\r\nkind: VirtualService\r\nmetadata:\r\n  name: reviews\r\nspec:\r\n  hosts:\r\n  - reviews\r\n  http:\r\n  - route:\r\n    - destination:\r\n        host: reviews\r\n        subset: v1\r\n      weight: 80\r\n    - destination:\r\n        host: reviews\r\n        subset: v2\r\n      weight: 20\n"})}),"\n",(0,s.jsx)(n.h3,{id:"linkerd",children:"Linkerd"}),"\n",(0,s.jsx)(n.p,{children:"L\xe9ger et simple"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Avantages :"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Performance excellente"}),"\n",(0,s.jsx)(n.li,{children:"Facilit\xe9 d'utilisation"}),"\n",(0,s.jsx)(n.li,{children:"Faible consommation ressources"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Inconv\xe9nients :"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Moins de fonctionnalit\xe9s qu'Istio"}),"\n",(0,s.jsx)(n.li,{children:"\xc9cosyst\xe8me plus restreint"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"consul-connect",children:"Consul Connect"}),"\n",(0,s.jsx)(n.p,{children:"Par HashiCorp"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Avantages :"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Int\xe9gration native avec Consul"}),"\n",(0,s.jsx)(n.li,{children:"Multi-datacenter"}),"\n",(0,s.jsx)(n.li,{children:"Support multi-plateforme (pas seulement K8s)"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"aws-app-mesh",children:"AWS App Mesh"}),"\n",(0,s.jsx)(n.p,{children:"Service manag\xe9 AWS"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Avantages :"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Z\xe9ro op\xe9rations (manag\xe9)"}),"\n",(0,s.jsx)(n.li,{children:"Int\xe9gration AWS native"}),"\n",(0,s.jsx)(n.li,{children:"Pay-as-you-go"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Inconv\xe9nients :"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Vendor lock-in"}),"\n",(0,s.jsx)(n.li,{children:"Uniquement AWS"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"-fonctionnalit\xe9s",children:"\ud83d\ude80 Fonctionnalit\xe9s"}),"\n",(0,s.jsx)(n.h3,{id:"1-traffic-management",children:"1. Traffic Management"}),"\n",(0,s.jsx)(n.h4,{id:"load-balancing-avanc\xe9",children:"Load Balancing avanc\xe9"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Round-robin pond\xe9r\xe9\r\n- destination:\r\n    host: api-service\r\n  weight: 80\r\n- destination:\r\n    host: api-service-canary\r\n  weight: 20\n"})}),"\n",(0,s.jsx)(n.h4,{id:"canary-deployment",children:"Canary Deployment"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Trafic progressif vers nouvelle version\r\nhttp:\r\n- match:\r\n  - headers:\r\n      user-type:\r\n        exact: beta\r\n  route:\r\n  - destination:\r\n      host: service\r\n      subset: v2\r\n- route:\r\n  - destination:\r\n      host: service\r\n      subset: v1\n"})}),"\n",(0,s.jsx)(n.h4,{id:"circuit-breaking",children:"Circuit Breaking"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: networking.istio.io/v1beta1\r\nkind: DestinationRule\r\nmetadata:\r\n  name: api-service\r\nspec:\r\n  host: api-service\r\n  trafficPolicy:\r\n    connectionPool:\r\n      tcp:\r\n        maxConnections: 100\r\n      http:\r\n        http1MaxPendingRequests: 50\r\n        maxRequestsPerConnection: 2\r\n    outlierDetection:\r\n      consecutiveErrors: 5\r\n      interval: 30s\r\n      baseEjectionTime: 30s\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-security",children:"2. Security"}),"\n",(0,s.jsx)(n.h4,{id:"mtls-automatique",children:"mTLS automatique"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Activer mTLS pour tout le namespace\r\napiVersion: security.istio.io/v1beta1\r\nkind: PeerAuthentication\r\nmetadata:\r\n  name: default\r\n  namespace: production\r\nspec:\r\n  mtls:\r\n    mode: STRICT\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Avantages :"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Chiffrement automatique"}),"\n",(0,s.jsx)(n.li,{children:"Gestion de certificats transparente"}),"\n",(0,s.jsx)(n.li,{children:"Rotation automatique"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"authorization-policies",children:"Authorization policies"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: security.istio.io/v1beta1\r\nkind: AuthorizationPolicy\r\nmetadata:\r\n  name: allow-read\r\nspec:\r\n  action: ALLOW\r\n  rules:\r\n  - from:\r\n    - source:\r\n        principals: ["cluster.local/ns/default/sa/frontend"]\r\n    to:\r\n    - operation:\r\n        methods: ["GET"]\n'})}),"\n",(0,s.jsx)(n.h3,{id:"3-observability",children:"3. Observability"}),"\n",(0,s.jsx)(n.h4,{id:"distributed-tracing",children:"Distributed Tracing"}),"\n",(0,s.jsx)(n.p,{children:"Propagation automatique des headers de tracing (Jaeger, Zipkin)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Aucune instrumentation n\xe9cessaire !\r\n# Le sidecar injecte automatiquement les span\n"})}),"\n",(0,s.jsx)(n.h4,{id:"m\xe9triques",children:"M\xe9triques"}),"\n",(0,s.jsx)(n.p,{children:"Collecte automatique des m\xe9triques standard :"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-promql",children:'# Latence P99\r\nhistogram_quantile(0.99, \r\n  rate(istio_request_duration_milliseconds_bucket[5m])\r\n)\r\n\r\n# Taux d\'erreur\r\nrate(istio_requests_total{response_code=~"5.."}[5m])\r\n\r\n# Trafic entrant\r\nsum(rate(istio_requests_total[5m])) by (destination_service)\n'})}),"\n",(0,s.jsx)(n.h4,{id:"service-graph",children:"Service Graph"}),"\n",(0,s.jsx)(n.p,{children:"Visualisation automatique des d\xe9pendances"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Frontend \u2192 API Gateway \u2192 User Service\r\n                      \u2192 Product Service \u2192 DB\n"})}),"\n",(0,s.jsx)(n.h3,{id:"4-resiliency",children:"4. Resiliency"}),"\n",(0,s.jsx)(n.h4,{id:"retry-automatique",children:"Retry automatique"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"http:\r\n- route:\r\n  - destination:\r\n      host: api-service\r\n  retries:\r\n    attempts: 3\r\n    perTryTimeout: 2s\r\n    retryOn: 5xx,reset,connect-failure\n"})}),"\n",(0,s.jsx)(n.h4,{id:"timeout",children:"Timeout"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"http:\r\n- route:\r\n  - destination:\r\n      host: slow-service\r\n  timeout: 5s\n"})}),"\n",(0,s.jsx)(n.h4,{id:"fault-injection-test-de-r\xe9silience",children:"Fault Injection (test de r\xe9silience)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Simuler 10% de latence pour tester\r\nhttp:\r\n- fault:\r\n    delay:\r\n      percentage:\r\n        value: 10\r\n      fixedDelay: 5s\r\n  route:\r\n  - destination:\r\n      host: service\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-cas-dusage",children:"\ud83c\udfa8 Cas d'usage"}),"\n",(0,s.jsx)(n.h3,{id:"1-migration-progressive-vers-microservices",children:"1. Migration progressive vers microservices"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Router 90% vers le monolithe, 10% vers microservice\r\nhttp:\r\n- route:\r\n  - destination:\r\n      host: monolith\r\n    weight: 90\r\n  - destination:\r\n      host: new-microservice\r\n    weight: 10\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-multi-cluster",children:"2. Multi-cluster"}),"\n",(0,s.jsx)(n.p,{children:"Distribuer le trafic entre plusieurs clusters Kubernetes"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Failover automatique\r\nhttp:\r\n- route:\r\n  - destination:\r\n      host: service.cluster-primary\r\n    weight: 100\r\n  mirror:\r\n    host: service.cluster-backup\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-ab-testing",children:"3. A/B Testing"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Envoyer utilisateurs premium vers version am\xe9lior\xe9e\r\nhttp:\r\n- match:\r\n  - headers:\r\n      user-tier:\r\n        exact: premium\r\n  route:\r\n  - destination:\r\n      subset: premium-version\r\n- route:\r\n  - destination:\r\n      subset: standard-version\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-performance",children:"\ud83d\udcca Performance"}),"\n",(0,s.jsx)(n.h3,{id:"overhead-typique",children:"Overhead typique"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"M\xe9trique"}),(0,s.jsx)(n.th,{children:"Sans Service Mesh"}),(0,s.jsx)(n.th,{children:"Avec Service Mesh"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Latency"})}),(0,s.jsx)(n.td,{children:"~1ms"}),(0,s.jsx)(n.td,{children:"~1-3ms (+1-2ms)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"CPU"})}),(0,s.jsx)(n.td,{children:"Baseline"}),(0,s.jsx)(n.td,{children:"+10-20%"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Memory"})}),(0,s.jsx)(n.td,{children:"Baseline"}),(0,s.jsx)(n.td,{children:"+50-100MB/pod"})]})]})]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:"L'overhead est souvent n\xe9gligeable compar\xe9 aux b\xe9n\xe9fices (s\xe9curit\xe9, observabilit\xe9)"})}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-consid\xe9rations",children:"\u26a0\ufe0f Consid\xe9rations"}),"\n",(0,s.jsx)(n.h3,{id:"quand-utiliser-un-service-mesh-",children:"Quand utiliser un Service Mesh ?"}),"\n",(0,s.jsxs)(n.p,{children:["\u2705 ",(0,s.jsx)(n.strong,{children:"Oui si :"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"10+ microservices"}),"\n",(0,s.jsx)(n.li,{children:"Besoin de mTLS universel"}),"\n",(0,s.jsx)(n.li,{children:"Observabilit\xe9 critique"}),"\n",(0,s.jsx)(n.li,{children:"D\xe9ploiements canary fr\xe9quents"}),"\n",(0,s.jsx)(n.li,{children:"Multi-cluster/multi-cloud"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u274c ",(0,s.jsx)(n.strong,{children:"Non si :"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"D\xe9but de projet (< 5 services)"}),"\n",(0,s.jsx)(n.li,{children:"\xc9quipe sans expertise Kubernetes"}),"\n",(0,s.jsx)(n.li,{children:"Contraintes de latence extr\xeames (< 5ms)"}),"\n",(0,s.jsx)(n.li,{children:"Infrastructure simple"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"complexit\xe9-op\xe9rationnelle",children:"Complexit\xe9 op\xe9rationnelle"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Comp\xe9tences requises :"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Kubernetes avanc\xe9"}),"\n",(0,s.jsx)(n.li,{children:"Networking (Envoy, iptables)"}),"\n",(0,s.jsx)(n.li,{children:"Certificats TLS"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Op\xe9rations :"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Mise \xe0 jour du control plane"}),"\n",(0,s.jsx)(n.li,{children:"Gestion des certificats"}),"\n",(0,s.jsx)(n.li,{children:"Debugging r\xe9seau complexe"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"-bonnes-pratiques",children:"\u2705 Bonnes pratiques"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Commencer simple"})," : activer progressivement les fonctionnalit\xe9s"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Namespace isolation"})," : segmenter par environnement"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Monitoring du mesh"})," : m\xe9triques du control plane et sidecars"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Limites de ressources"})," : d\xe9finir requests/limits pour sidecars"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Strat\xe9gie mTLS"})," : PERMISSIVE \u2192 STRICT progressivement"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Versioning des configurations"})," : GitOps pour les ressources mesh"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Plan de rollback"})," : pouvoir d\xe9sactiver rapidement"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"-migration-progressive",children:"\ud83e\uddea Migration progressive"}),"\n",(0,s.jsx)(n.h3,{id:"phase-1--observability",children:"Phase 1 : Observability"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# Activer uniquement les m\xe9triques et traces\r\nannotations:\r\n  sidecar.istio.io/inject: "true"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"phase-2--security",children:"Phase 2 : Security"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Activer mTLS en mode permissif\r\nmtls:\r\n  mode: PERMISSIVE  # Accepte TLS et plain\n"})}),"\n",(0,s.jsx)(n.h3,{id:"phase-3--traffic-management",children:"Phase 3 : Traffic Management"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Activer circuit breaker, retry, etc.\r\ntrafficPolicy:\r\n  connectionPool: {...}\r\n  outlierDetection: {...}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"phase-4--strict-mode",children:"Phase 4 : Strict Mode"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"# Forcer mTLS pour tout\r\nmtls:\r\n  mode: STRICT\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-m\xe9triques-cl\xe9s",children:"\ud83d\udcc8 M\xe9triques cl\xe9s"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-promql",children:'# Sant\xe9 du control plane\r\nup{job="istiod"}\r\n\r\n# Latence ajout\xe9e par sidecar\r\nhistogram_quantile(0.99, envoy_cluster_upstream_rq_time_bucket)\r\n\r\n# Taux de connexion TLS\r\nrate(istio_tcp_connections_opened_total{security_policy="mutual_tls"}[5m])\r\n\r\n# Memory sidecar\r\ncontainer_memory_usage_bytes{container="istio-proxy"}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"ressources",children:"Ressources"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://istio.io/latest/docs/",children:"Istio Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://linkerd.io/",children:"Linkerd"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.nginx.com/resources/library/the-service-mesh/",children:"The Service Mesh: What Every Software Engineer Needs to Know (Book)"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://landscape.cncf.io/card-mode?category=service-mesh",children:"CNCF Service Mesh Landscape"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);