"use strict";(globalThis.webpackChunkdocusaurus_poc=globalThis.webpackChunkdocusaurus_poc||[]).push([[8352],{6064:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"development/java/data-layer/mutli-tenancy","title":"Multi-Tenancy (Multi-Locataire)","description":"Le multi-tenancy permet d\'h\xe9berger une application unique pour plusieurs clients (tenants/locataires) tout en garantissant l\'isolation de leurs donn\xe9es. Chaque tenant dispose de son propre espace isol\xe9 au sein de la m\xeame infrastructure.","source":"@site/docs/development/java/data-layer/mutli-tenancy.md","sourceDirName":"development/java/data-layer","slug":"/development/java/data-layer/mutli-tenancy","permalink":"/docs/development/java/data-layer/mutli-tenancy","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/development/java/data-layer/mutli-tenancy.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docs","previous":{"title":"Couche donn\xe9es","permalink":"/docs/development/java/data-layer/"},"next":{"title":"Audit des entit\xe9s","permalink":"/docs/development/java/data-layer/logging"}}');var t=s(4848),r=s(8453);const a={sidebar_position:1},l="Multi-Tenancy (Multi-Locataire)",d={},c=[{value:"Cas d&#39;usage",id:"cas-dusage",level:2},{value:"Strat\xe9gies de Multi-Tenancy",id:"strat\xe9gies-de-multi-tenancy",level:2},{value:"1. Base de donn\xe9es par tenant (Database-per-tenant)",id:"1-base-de-donn\xe9es-par-tenant-database-per-tenant",level:3},{value:"2. Sch\xe9ma par tenant (Schema-per-tenant)",id:"2-sch\xe9ma-par-tenant-schema-per-tenant",level:3},{value:"3. Colonne discriminante (Shared Database with Discriminator)",id:"3-colonne-discriminante-shared-database-with-discriminator",level:3},{value:"Tableau comparatif",id:"tableau-comparatif",level:2},{value:"Recommandations",id:"recommandations",level:2},{value:"Bonnes pratiques communes",id:"bonnes-pratiques-communes",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"multi-tenancy-multi-locataire",children:"Multi-Tenancy (Multi-Locataire)"})}),"\n",(0,t.jsx)(n.p,{children:"Le multi-tenancy permet d'h\xe9berger une application unique pour plusieurs clients (tenants/locataires) tout en garantissant l'isolation de leurs donn\xe9es. Chaque tenant dispose de son propre espace isol\xe9 au sein de la m\xeame infrastructure."}),"\n",(0,t.jsx)(n.h2,{id:"cas-dusage",children:"Cas d'usage"}),"\n",(0,t.jsx)(n.p,{children:"Vous d\xe9veloppez une application SaaS que vous souhaitez proposer \xe0 plusieurs entreprises clientes. Chaque entreprise doit :"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Acc\xe9der \xe0 ses propres donn\xe9es de mani\xe8re isol\xe9e"}),"\n",(0,t.jsx)(n.li,{children:"Ne jamais voir les donn\xe9es des autres clients"}),"\n",(0,t.jsx)(n.li,{children:"B\xe9n\xe9ficier d'une exp\xe9rience personnalis\xe9e"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"strat\xe9gies-de-multi-tenancy",children:"Strat\xe9gies de Multi-Tenancy"}),"\n",(0,t.jsx)(n.h3,{id:"1-base-de-donn\xe9es-par-tenant-database-per-tenant",children:"1. Base de donn\xe9es par tenant (Database-per-tenant)"}),"\n",(0,t.jsx)(n.p,{children:"Chaque tenant poss\xe8de sa propre base de donn\xe9es d\xe9di\xe9e."}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Isolation"})," : \u2b50\u2b50\u2b50\u2b50\u2b50 Maximale"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Fonctionnement"})," :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Tenant A \u2192 Database A\r\nTenant B \u2192 Database B  \r\nTenant C \u2192 Database C\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Avantages"})," :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Isolation compl\xe8te des donn\xe9es (s\xe9curit\xe9 maximale)"}),"\n",(0,t.jsx)(n.li,{children:"Facilit\xe9 de sauvegarde/restauration par tenant"}),"\n",(0,t.jsx)(n.li,{children:"Migration simple d'un tenant vers une autre infrastructure"}),"\n",(0,t.jsx)(n.li,{children:"Performance pr\xe9visible par tenant"}),"\n",(0,t.jsx)(n.li,{children:"Personnalisation possible par client (versions de sch\xe9ma diff\xe9rentes)"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Inconv\xe9nients"})," :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Co\xfbt de maintenance \xe9lev\xe9 (multiplication des bases)"}),"\n",(0,t.jsx)(n.li,{children:"Complexit\xe9 de gestion avec un grand nombre de tenants"}),"\n",(0,t.jsx)(n.li,{children:"Gestion des connexions complexe"}),"\n",(0,t.jsx)(n.li,{children:"Migrations de sch\xe9ma \xe0 r\xe9p\xe9ter sur toutes les bases"}),"\n",(0,t.jsx)(n.li,{children:"Co\xfbt d'infrastructure plus \xe9lev\xe9"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Quand l'utiliser"})," :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Petit nombre de tenants (< 100)"}),"\n",(0,t.jsx)(n.li,{children:"Clients n\xe9cessitant une isolation stricte (banques, sant\xe9)"}),"\n",(0,t.jsx)(n.li,{children:"Besoins de personnalisation forte par client"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"2-sch\xe9ma-par-tenant-schema-per-tenant",children:"2. Sch\xe9ma par tenant (Schema-per-tenant)"}),"\n",(0,t.jsx)(n.p,{children:"Une base de donn\xe9es unique avec un sch\xe9ma distinct par tenant."}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Isolation"})," : \u2b50\u2b50\u2b50\u2b50 \xc9lev\xe9e"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Fonctionnement"})," :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Database unique\r\n\u251c\u2500\u2500 Schema tenant_a (tables users, orders...)\r\n\u251c\u2500\u2500 Schema tenant_b (tables users, orders...)\r\n\u2514\u2500\u2500 Schema tenant_c (tables users, orders...)\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Avantages"})," :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Bon compromis isolation/performance"}),"\n",(0,t.jsx)(n.li,{children:"Gestion simplifi\xe9e par rapport au database-per-tenant"}),"\n",(0,t.jsx)(n.li,{children:"Une seule connexion \xe0 la base de donn\xe9es"}),"\n",(0,t.jsx)(n.li,{children:"Backup centralis\xe9 possible"}),"\n",(0,t.jsx)(n.li,{children:"Meilleure utilisation des ressources"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Inconv\xe9nients"})," :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Complexit\xe9 croissante avec le nombre de sch\xe9mas"}),"\n",(0,t.jsx)(n.li,{children:"Migrations de sch\xe9ma \xe0 g\xe9rer pour chaque tenant"}),"\n",(0,t.jsx)(n.li,{children:"Risque d'erreur de contexte (mauvais sch\xe9ma)"}),"\n",(0,t.jsx)(n.li,{children:"Limite du nombre de sch\xe9mas selon le SGBD"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Quand l'utiliser"})," :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Nombre moyen de tenants (100-1000)"}),"\n",(0,t.jsx)(n.li,{children:"Besoin d'isolation sans co\xfbt d'infrastructure trop \xe9lev\xe9"}),"\n",(0,t.jsx)(n.li,{children:"PostgreSQL ou bases supportant bien les sch\xe9mas multiples"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h3,{id:"3-colonne-discriminante-shared-database-with-discriminator",children:"3. Colonne discriminante (Shared Database with Discriminator)"}),"\n",(0,t.jsxs)(n.p,{children:["Tous les tenants partagent les m\xeames tables avec une colonne ",(0,t.jsx)(n.code,{children:"tenant_id"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Isolation"})," : \u2b50\u2b50 Logique uniquement"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Fonctionnement"})," :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"Table users:\r\n| id | name    | email          | tenant_id |\r\n|----|---------|----------------|-----------|\r\n| 1  | Alice   | a@tenant-a.com | tenant_a  |\r\n| 2  | Bob     | b@tenant-b.com | tenant_b  |\r\n| 3  | Charlie | c@tenant-a.com | tenant_a  |\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Avantages"})," :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Simplicit\xe9 de mise en \u0153uvre"}),"\n",(0,t.jsx)(n.li,{children:"Excellente scalabilit\xe9 (milliers de tenants)"}),"\n",(0,t.jsx)(n.li,{children:"Une seule base et un seul sch\xe9ma"}),"\n",(0,t.jsx)(n.li,{children:"Migrations simples"}),"\n",(0,t.jsx)(n.li,{children:"Co\xfbt d'infrastructure minimal"}),"\n",(0,t.jsx)(n.li,{children:"Requ\xeates cross-tenant possibles (analytics)"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Inconv\xe9nients"})," :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Isolation faible (risque de fuite de donn\xe9es)"}),"\n",(0,t.jsx)(n.li,{children:"Performance d\xe9grad\xe9e avec gros volume de donn\xe9es"}),"\n",(0,t.jsx)(n.li,{children:"Index et requ\xeates plus complexes"}),"\n",(0,t.jsx)(n.li,{children:"N\xe9cessite une rigueur extr\xeame dans le code"}),"\n",(0,t.jsx)(n.li,{children:"Backup/restauration par tenant impossible"}),"\n",(0,t.jsx)(n.li,{children:"Personnalisation par tenant limit\xe9e"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Impl\xe9mentation critique"})," :"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'// \u274c DANGER : Requ\xeate sans filtre tenant\r\n@Query("SELECT u FROM User u")\r\nList<User> findAll();\r\n\r\n// \u2705 OBLIGATOIRE : Toujours filtrer par tenant\r\n@Query("SELECT u FROM User u WHERE u.tenantId = :tenantId")\r\nList<User> findAllByTenant(@Param("tenantId") String tenantId);\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Quand l'utiliser"})," :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Grand nombre de tenants (> 1000)"}),"\n",(0,t.jsx)(n.li,{children:"Donn\xe9es similaires entre tenants"}),"\n",(0,t.jsx)(n.li,{children:"Priorit\xe9 \xe0 la scalabilit\xe9 et au co\xfbt"}),"\n",(0,t.jsx)(n.li,{children:"Application avec mesures de s\xe9curit\xe9 strictes au niveau code"}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"tableau-comparatif",children:"Tableau comparatif"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Crit\xe8re"}),(0,t.jsx)(n.th,{children:"Database-per-tenant"}),(0,t.jsx)(n.th,{children:"Schema-per-tenant"}),(0,t.jsx)(n.th,{children:"Discriminator"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Isolation"})}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50\u2b50\u2b50\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50\u2b50\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Scalabilit\xe9"})}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50\u2b50"}),(0,t.jsx)(n.td,{children:"\u2b50\u2b50\u2b50\u2b50\u2b50"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Co\xfbt"})}),(0,t.jsx)(n.td,{children:"\xc9lev\xe9"}),(0,t.jsx)(n.td,{children:"Moyen"}),(0,t.jsx)(n.td,{children:"Faible"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Complexit\xe9"})}),(0,t.jsx)(n.td,{children:"\xc9lev\xe9e"}),(0,t.jsx)(n.td,{children:"Moyenne"}),(0,t.jsx)(n.td,{children:"Faible"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Nb tenants max"})}),(0,t.jsx)(n.td,{children:"< 100"}),(0,t.jsx)(n.td,{children:"100-1000"}),(0,t.jsx)(n.td,{children:"> 1000"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.strong,{children:"Performance"})}),(0,t.jsx)(n.td,{children:"Excellente"}),(0,t.jsx)(n.td,{children:"Bonne"}),(0,t.jsx)(n.td,{children:"Variable"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"recommandations",children:"Recommandations"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Choisissez Database-per-tenant si"})," :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Vous avez < 50 clients avec gros volumes de donn\xe9es"}),"\n",(0,t.jsx)(n.li,{children:"Compliance stricte requise (RGPD, HIPAA)"}),"\n",(0,t.jsx)(n.li,{children:"Budget infrastructure disponible"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Choisissez Schema-per-tenant si"})," :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Vous avez 100-1000 clients"}),"\n",(0,t.jsx)(n.li,{children:"Bon compromis isolation/co\xfbt recherch\xe9"}),"\n",(0,t.jsx)(n.li,{children:"Vous utilisez PostgreSQL"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Choisissez Discriminator si"})," :"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Vous avez > 1000 clients"}),"\n",(0,t.jsx)(n.li,{children:"Startups/MVP avec croissance rapide"}),"\n",(0,t.jsx)(n.li,{children:"Co\xfbt d'infrastructure prioritaire"}),"\n",(0,t.jsx)(n.li,{children:"\xc9quipe mature en d\xe9veloppement s\xe9curis\xe9"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"bonnes-pratiques-communes",children:"Bonnes pratiques communes"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Identifiez le tenant d\xe8s l'authentification"})," et stockez-le dans le contexte de s\xe9curit\xe9"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Utilisez des intercepteurs"})," pour injecter automatiquement le tenant dans les requ\xeates"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Testez l'isolation"})," avec des tests automatis\xe9s multi-tenants"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Auditez les acc\xe8s"})," pour d\xe9tecter les fuites de donn\xe9es potentielles"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Documentez"})," clairement la strat\xe9gie choisie pour toute l'\xe9quipe"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var i=s(6540);const t={},r=i.createContext(t);function a(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);