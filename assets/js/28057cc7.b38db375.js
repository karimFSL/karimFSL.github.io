"use strict";(globalThis.webpackChunkdocusaurus_poc=globalThis.webpackChunkdocusaurus_poc||[]).push([[3508],{5993:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"microservices/data-management/data-management","title":"Data Management","description":"Introduction","source":"@site/docs/microservices/data-management/data-management.md","sourceDirName":"microservices/data-management","slug":"/microservices/data-management/","permalink":"/docs/microservices/data-management/","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/microservices/data-management/data-management.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"docs","previous":{"title":"Types de communication","permalink":"/docs/microservices/communication/types"},"next":{"title":"Patterns","permalink":"/docs/microservices/patterns/"}}');var r=s(4848),t=s(8453);const l={sidebar_position:4},c="Data Management",d={},a=[{value:"Introduction",id:"introduction",level:2},{value:"\ud83c\udfaf Principe fondamental",id:"-principe-fondamental",level:2},{value:"\ud83d\udd17 Pourquoi s\xe9parer les bases de donn\xe9es ?",id:"-pourquoi-s\xe9parer-les-bases-de-donn\xe9es-",level:2},{value:"1. D\xe9couplage",id:"1-d\xe9couplage",level:3},{value:"2. Scalabilit\xe9",id:"2-scalabilit\xe9",level:3},{value:"3. R\xe9silience",id:"3-r\xe9silience",level:3},{value:"\ud83d\uddc4\ufe0f Strat\xe9gies de s\xe9paration",id:"\ufe0f-strat\xe9gies-de-s\xe9paration",level:2},{value:"\ud83e\udde9 Polyglot Persistence",id:"-polyglot-persistence",level:2},{value:"Exemples",id:"exemples",level:3},{value:"\u26a0\ufe0f D\xe9fis et solutions",id:"\ufe0f-d\xe9fis-et-solutions",level:2},{value:"1. Transactions distribu\xe9es",id:"1-transactions-distribu\xe9es",level:3},{value:"2. Requ\xeates multi-services",id:"2-requ\xeates-multi-services",level:3},{value:"API Composition",id:"api-composition",level:4},{value:"CQRS (Command Query Responsibility Segregation)",id:"cqrs-command-query-responsibility-segregation",level:4},{value:"Data Duplication",id:"data-duplication",level:4},{value:"3. Coh\xe9rence des donn\xe9es",id:"3-coh\xe9rence-des-donn\xe9es",level:3},{value:"Event-Driven Updates",id:"event-driven-updates",level:4},{value:"Change Data Capture (CDC)",id:"change-data-capture-cdc",level:4},{value:"\ud83d\udd04 Patterns de coh\xe9rence",id:"-patterns-de-coh\xe9rence",level:2},{value:"Eventual Consistency",id:"eventual-consistency",level:3},{value:"Strong Consistency",id:"strong-consistency",level:3},{value:"\ud83d\udcca Monitoring et observabilit\xe9",id:"-monitoring-et-observabilit\xe9",level:2},{value:"M\xe9triques importantes",id:"m\xe9triques-importantes",level:3},{value:"Outils",id:"outils",level:3},{value:"\u2705 Bonnes pratiques",id:"-bonnes-pratiques",level:2},{value:"Ressources",id:"ressources",level:2}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"data-management",children:"Data Management"})}),"\n",(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsx)(n.p,{children:"La gestion des donn\xe9es dans une architecture microservices est un d\xe9fi majeur. Contrairement aux monolithes avec une seule base de donn\xe9es, les microservices n\xe9cessitent des strat\xe9gies sp\xe9cifiques pour maintenir la coh\xe9rence tout en pr\xe9servant l'autonomie des services."}),"\n",(0,r.jsx)(n.h2,{id:"-principe-fondamental",children:"\ud83c\udfaf Principe fondamental"}),"\n",(0,r.jsx)(n.admonition,{title:"Database per Service",type:"tip",children:(0,r.jsxs)(n.p,{children:["Chaque microservice poss\xe8de sa ",(0,r.jsx)(n.strong,{children:"propre base de donn\xe9es"})," et ne doit jamais acc\xe9der directement \xe0 celle d'un autre service."]})}),"\n",(0,r.jsx)(n.h2,{id:"-pourquoi-s\xe9parer-les-bases-de-donn\xe9es-",children:"\ud83d\udd17 Pourquoi s\xe9parer les bases de donn\xe9es ?"}),"\n",(0,r.jsx)(n.h3,{id:"1-d\xe9couplage",children:"1. D\xe9couplage"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Sch\xe9ma ind\xe9pendant"})," : modifications sans coordination entre \xe9quipes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"D\xe9ploiements autonomes"})," : pas de migration BDD bloquante"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\xc9volution technologique"})," : chaque service choisit sa stack"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-scalabilit\xe9",children:"2. Scalabilit\xe9"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Performance cibl\xe9e"})," : optimisation par service"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Charge distribu\xe9e"})," : pas de goulot d'\xe9tranglement unique"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scaling ind\xe9pendant"})," : dimensionnement adapt\xe9 aux besoins"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-r\xe9silience",children:"3. R\xe9silience"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Isolation des pannes"})," : une BDD en panne n'affecte qu'un service"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Blast radius limit\xe9"})," : corruption de donn\xe9es localis\xe9e"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-strat\xe9gies-de-s\xe9paration",children:"\ud83d\uddc4\ufe0f Strat\xe9gies de s\xe9paration"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Niveau"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Avantages"}),(0,r.jsx)(n.th,{children:"Inconv\xe9nients"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Sch\xe9ma d\xe9di\xe9"})}),(0,r.jsx)(n.td,{children:"Sch\xe9mas diff\xe9rents, m\xeame serveur BDD"}),(0,r.jsx)(n.td,{children:"Simple, co\xfbt r\xe9duit"}),(0,r.jsx)(n.td,{children:"Acc\xe8s non contr\xf4l\xe9s possibles"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Base par service"})}),(0,r.jsx)(n.td,{children:"Bases s\xe9par\xe9es, serveur partag\xe9"}),(0,r.jsx)(n.td,{children:"S\xe9paration logique claire"}),(0,r.jsx)(n.td,{children:"Couplage physique"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Serveur par service"})}),(0,r.jsx)(n.td,{children:"Base + serveur d\xe9di\xe9s"}),(0,r.jsx)(n.td,{children:"Isolation maximale"}),(0,r.jsx)(n.td,{children:"Co\xfbt et complexit\xe9 \xe9lev\xe9s"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"-polyglot-persistence",children:"\ud83e\udde9 Polyglot Persistence"}),"\n",(0,r.jsx)(n.p,{children:"Chaque service peut choisir la technologie de base de donn\xe9es la plus adapt\xe9e \xe0 son besoin."}),"\n",(0,r.jsx)(n.h3,{id:"exemples",children:"Exemples"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Service"}),(0,r.jsx)(n.th,{children:"Type de donn\xe9es"}),(0,r.jsx)(n.th,{children:"Technologie recommand\xe9e"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Catalogue produits"})}),(0,r.jsx)(n.td,{children:"Documents structur\xe9s"}),(0,r.jsx)(n.td,{children:"MongoDB, PostgreSQL (JSONB)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Panier"})}),(0,r.jsx)(n.td,{children:"Cache temporaire, TTL"}),(0,r.jsx)(n.td,{children:"Redis, Memcached"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Recommandations"})}),(0,r.jsx)(n.td,{children:"Graphe de relations"}),(0,r.jsx)(n.td,{children:"Neo4j, Amazon Neptune"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Transactions"})}),(0,r.jsx)(n.td,{children:"ACID strict"}),(0,r.jsx)(n.td,{children:"PostgreSQL, MySQL"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Logs/Metrics"})}),(0,r.jsx)(n.td,{children:"Time-series"}),(0,r.jsx)(n.td,{children:"InfluxDB, TimescaleDB"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Search"})}),(0,r.jsx)(n.td,{children:"Full-text search"}),(0,r.jsx)(n.td,{children:"Elasticsearch, OpenSearch"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"\ufe0f-d\xe9fis-et-solutions",children:"\u26a0\ufe0f D\xe9fis et solutions"}),"\n",(0,r.jsx)(n.h3,{id:"1-transactions-distribu\xe9es",children:"1. Transactions distribu\xe9es"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Probl\xe8me :"})," Pas de transaction ACID globale entre services"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solutions :"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"[Saga Pattern] - Compensation en cas d'\xe9chec"}),"\n",(0,r.jsx)(n.li,{children:"[Event Sourcing] - Source de v\xe9rit\xe9 unique"}),"\n",(0,r.jsx)(n.li,{children:"Eventual Consistency - Accepter la coh\xe9rence diff\xe9r\xe9e"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-requ\xeates-multi-services",children:"2. Requ\xeates multi-services"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Probl\xe8me :"})," Impossible de faire un JOIN entre bases"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solutions :"})}),"\n",(0,r.jsx)(n.h4,{id:"api-composition",children:"API Composition"}),"\n",(0,r.jsx)(n.p,{children:"Le service agr\xe9gateur interroge plusieurs services"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"def get_order_details(order_id):\r\n    order = order_service.get(order_id)\r\n    user = user_service.get(order.user_id)\r\n    products = product_service.get_many(order.product_ids)\r\n    return aggregate(order, user, products)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"cqrs-command-query-responsibility-segregation",children:"CQRS (Command Query Responsibility Segregation)"}),"\n",(0,r.jsx)(n.p,{children:"Vues mat\xe9rialis\xe9es en lecture"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Base d'\xe9criture normalis\xe9e par service"}),"\n",(0,r.jsx)(n.li,{children:"Base de lecture d\xe9normalis\xe9e pour requ\xeates complexes"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"data-duplication",children:"Data Duplication"}),"\n",(0,r.jsx)(n.p,{children:"Dupliquer les donn\xe9es essentielles"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\r\n  "order_id": "123",\r\n  "user_id": "456",\r\n  "user_name": "John Doe",  // Dupliqu\xe9 du user service\r\n  "user_email": "john@example.com"  // Dupliqu\xe9\r\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"3-coh\xe9rence-des-donn\xe9es",children:"3. Coh\xe9rence des donn\xe9es"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Probl\xe8me :"})," Donn\xe9es synchronis\xe9es entre services"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Solutions :"})}),"\n",(0,r.jsx)(n.h4,{id:"event-driven-updates",children:"Event-Driven Updates"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// User Service publie un \xe9v\xe9nement\r\neventBus.publish('user.updated', {\r\n  user_id: '456',\r\n  name: 'Jane Doe',\r\n  email: 'jane@example.com'\r\n});\r\n\r\n// Order Service \xe9coute et met \xe0 jour sa copie\r\neventBus.subscribe('user.updated', (event) => {\r\n  updateUserInfoInOrders(event.user_id, event);\r\n});\n"})}),"\n",(0,r.jsx)(n.h4,{id:"change-data-capture-cdc",children:"Change Data Capture (CDC)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Debezium capture les changements dans la BDD"}),"\n",(0,r.jsx)(n.li,{children:"Publie automatiquement les \xe9v\xe9nements"}),"\n",(0,r.jsx)(n.li,{children:"Services consommateurs se synchronisent"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"-patterns-de-coh\xe9rence",children:"\ud83d\udd04 Patterns de coh\xe9rence"}),"\n",(0,r.jsx)(n.h3,{id:"eventual-consistency",children:"Eventual Consistency"}),"\n",(0,r.jsx)(n.p,{children:"Accepter que les donn\xe9es soient temporairement incoh\xe9rentes"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Avantages :"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Haute disponibilit\xe9"}),"\n",(0,r.jsx)(n.li,{children:"Meilleure performance"}),"\n",(0,r.jsx)(n.li,{children:"Scalabilit\xe9"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Inconv\xe9nients :"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Complexit\xe9 m\xe9tier"}),"\n",(0,r.jsx)(n.li,{children:"UI doit g\xe9rer l'\xe9tat transitoire"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Exemple :"})," Syst\xe8me bancaire"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"1. D\xe9bit compte A \u2192 succ\xe8s\r\n2. Cr\xe9dit compte B \u2192 succ\xe8s (avec d\xe9lai)\r\n3. \xc9tat transitoire visible pendant quelques secondes\n"})}),"\n",(0,r.jsx)(n.h3,{id:"strong-consistency",children:"Strong Consistency"}),"\n",(0,r.jsx)(n.p,{children:"Coh\xe9rence imm\xe9diate (2PC, Saga synchrone)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Usage :"})," Transactions critiques uniquement (paiements, stocks)"]}),"\n",(0,r.jsx)(n.h2,{id:"-monitoring-et-observabilit\xe9",children:"\ud83d\udcca Monitoring et observabilit\xe9"}),"\n",(0,r.jsx)(n.h3,{id:"m\xe9triques-importantes",children:"M\xe9triques importantes"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Replication lag"})," : d\xe9lai de synchronisation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Consistency violations"})," : incoh\xe9rences d\xe9tect\xe9es"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Query performance"})," : temps de r\xe9ponse inter-services"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Database connection pool"})," : saturation"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"outils",children:"Outils"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Distributed Tracing"})," : Jaeger, Zipkin"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Logs centralis\xe9s"})," : ELK Stack, Splunk"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"M\xe9triques"})," : Prometheus, Grafana"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"-bonnes-pratiques",children:"\u2705 Bonnes pratiques"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Commencer simple"})," : une base partag\xe9e initialement, puis s\xe9parer progressivement"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"D\xe9finir les boundaries"})," : aligner les services avec les domaines m\xe9tier (DDD)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Accepter la duplication"})," : pr\xe9f\xe9rer la duplication au couplage"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Eventual consistency by default"})," : coh\xe9rence forte seulement si n\xe9cessaire"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Versionner les sch\xe9mas"})," : migrations sans downtime"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Audit trail"})," : tra\xe7abilit\xe9 des changements critiques"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"ressources",children:"Ressources"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://microservices.io/patterns/data/database-per-service.html",children:"Pattern: Database per service"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://martinfowler.com/bliki/PolyglotPersistence.html",children:"Martin Fowler - Polyglot Persistence"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://martinfowler.com/articles/201701-event-driven.html",children:"Event-Driven Architecture"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>c});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);