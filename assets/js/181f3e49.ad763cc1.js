"use strict";(globalThis.webpackChunkdocusaurus_poc=globalThis.webpackChunkdocusaurus_poc||[]).push([[3272],{8085:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>t,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"microservices/patterns/cqrs","title":"CQRS (Command Query Responsibility Segregation)","description":"Concept","source":"@site/docs/microservices/patterns/cqrs.md","sourceDirName":"microservices/patterns","slug":"/microservices/patterns/cqrs","permalink":"/docs/microservices/patterns/cqrs","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/microservices/patterns/cqrs.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Circuit Breaker Pattern","permalink":"/docs/microservices/patterns/circuit-breaker"},"next":{"title":"Event Sourcing","permalink":"/docs/microservices/patterns/event-sourcing"}}');var s=r(4848),d=r(8453);const t={},l="CQRS (Command Query Responsibility Segregation)",a={},o=[{value:"Concept",id:"concept",level:2},{value:"\ud83c\udfaf Probl\xe8me r\xe9solu",id:"-probl\xe8me-r\xe9solu",level:2},{value:"Approche traditionnelle",id:"approche-traditionnelle",level:3},{value:"Avec CQRS",id:"avec-cqrs",level:3},{value:"\ud83c\udfd7\ufe0f Architecture",id:"\ufe0f-architecture",level:2},{value:"S\xe9paration Command/Query",id:"s\xe9paration-commandquery",level:3},{value:"Synchronisation Read Model",id:"synchronisation-read-model",level:3},{value:"\ud83d\udcbb Impl\xe9mentation",id:"-impl\xe9mentation",level:2},{value:"API REST",id:"api-rest",level:3},{value:"Technologies Read DB",id:"technologies-read-db",level:3},{value:"\ud83d\udd04 Eventual Consistency",id:"-eventual-consistency",level:2},{value:"G\xe9rer l&#39;UI",id:"g\xe9rer-lui",level:3},{value:"\ud83c\udfa8 Niveaux de CQRS",id:"-niveaux-de-cqrs",level:2},{value:"Niveau 1 : S\xe9paration logique",id:"niveau-1--s\xe9paration-logique",level:3},{value:"Niveau 2 : S\xe9paration physique",id:"niveau-2--s\xe9paration-physique",level:3},{value:"Niveau 3 : Technologies diff\xe9rentes",id:"niveau-3--technologies-diff\xe9rentes",level:3},{value:"\u2705 Avantages",id:"-avantages",level:2},{value:"1. Performance",id:"1-performance",level:3},{value:"2. Scalabilit\xe9",id:"2-scalabilit\xe9",level:3},{value:"3. Optimisation cibl\xe9e",id:"3-optimisation-cibl\xe9e",level:3},{value:"4. Flexibilit\xe9",id:"4-flexibilit\xe9",level:3},{value:"\u26a0\ufe0f Inconv\xe9nients",id:"\ufe0f-inconv\xe9nients",level:2},{value:"1. Complexit\xe9",id:"1-complexit\xe9",level:3},{value:"2. Eventual Consistency",id:"2-eventual-consistency",level:3},{value:"3. Duplication de donn\xe9es",id:"3-duplication-de-donn\xe9es",level:3},{value:"4. Synchronisation",id:"4-synchronisation",level:3},{value:"\ud83d\udee0\ufe0f Frameworks",id:"\ufe0f-frameworks",level:2},{value:"Axon Framework (Java)",id:"axon-framework-java",level:3},{value:"MediatR (.NET)",id:"mediatr-net",level:3},{value:"\ud83d\udcca Quand utiliser CQRS ?",id:"-quand-utiliser-cqrs-",level:2},{value:"\u2705 Cas appropri\xe9s",id:"-cas-appropri\xe9s",level:3},{value:"\u274c \xc9viter si",id:"-\xe9viter-si",level:3},{value:"\u2705 Bonnes pratiques",id:"-bonnes-pratiques",level:2},{value:"\ud83e\uddea Tests",id:"-tests",level:2},{value:"Ressources",id:"ressources",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"cqrs-command-query-responsibility-segregation",children:"CQRS (Command Query Responsibility Segregation)"})}),"\n",(0,s.jsx)(n.h2,{id:"concept",children:"Concept"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"CQRS"})," s\xe9pare les op\xe9rations de ",(0,s.jsx)(n.strong,{children:"lecture"})," (Query) et d'",(0,s.jsx)(n.strong,{children:"\xe9criture"})," (Command) en utilisant des mod\xe8les de donn\xe9es diff\xe9rents."]}),"\n",(0,s.jsx)(n.admonition,{title:"Principe",type:"tip",children:(0,s.jsx)(n.p,{children:"Un mod\xe8le optimis\xe9 pour l'\xe9criture, un autre pour la lecture."})}),"\n",(0,s.jsx)(n.h2,{id:"-probl\xe8me-r\xe9solu",children:"\ud83c\udfaf Probl\xe8me r\xe9solu"}),"\n",(0,s.jsx)(n.h3,{id:"approche-traditionnelle",children:"Approche traditionnelle"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  API Controller  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n    \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510\n    \u2502 Service \u2502\n    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518\n         \u2502\n    \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510\n    \u2502   BDD   \u2502  \u25c4\u2500\u2500 M\xeame mod\xe8le lecture/\xe9criture\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Probl\xe8mes :"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Mod\xe8le de donn\xe9es compromis entre lecture et \xe9criture"}),"\n",(0,s.jsx)(n.li,{children:"Requ\xeates complexes avec JOINs multiples"}),"\n",(0,s.jsx)(n.li,{children:"Scaling difficile (m\xeame BDD pour tout)"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"avec-cqrs",children:"Avec CQRS"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Commands (Write)          Queries (Read)\n     \u2502                         \u2502\n\u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2510            \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510\n\u2502 Write DB \u2502 \u2500Events\u2500\u2192  \u2502 Read DB  \u2502\n\u2502 (Normal) \u2502            \u2502 (D\xe9nom.) \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Avantages :"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Mod\xe8les optimis\xe9s s\xe9par\xe9ment"}),"\n",(0,s.jsx)(n.li,{children:"Scalabilit\xe9 ind\xe9pendante"}),"\n",(0,s.jsx)(n.li,{children:"Lecture ultra-rapide (donn\xe9es d\xe9normalis\xe9es)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-architecture",children:"\ud83c\udfd7\ufe0f Architecture"}),"\n",(0,s.jsx)(n.h3,{id:"s\xe9paration-commandquery",children:"S\xe9paration Command/Query"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// ============ COMMANDS (Write Side) ============\n\nclass CreateOrderCommand {\n  constructor(userId, items) {\n    this.userId = userId;\n    this.items = items;\n  }\n}\n\nclass OrderCommandHandler {\n  async handle(command) {\n    // Validation m\xe9tier\n    if (command.items.length === 0) {\n      throw new Error('Order must have items');\n    }\n    \n    // \xc9crire dans Write DB (normalis\xe9)\n    const order = await Order.create({\n      userId: command.userId,\n      status: 'PENDING'\n    });\n    \n    await OrderItem.bulkCreate(\n      command.items.map(item => ({\n        orderId: order.id,\n        productId: item.productId,\n        quantity: item.quantity\n      }))\n    );\n    \n    // Publier \xe9v\xe9nement pour synchronisation\n    eventBus.publish('OrderCreated', { orderId: order.id });\n    \n    return order.id;\n  }\n}\n\n// ============ QUERIES (Read Side) ============\n\nclass GetOrderDetailsQuery {\n  constructor(orderId) {\n    this.orderId = orderId;\n  }\n}\n\nclass OrderQueryHandler {\n  async handle(query) {\n    // Lecture depuis Read DB (d\xe9normalis\xe9, pr\xe9-joint\xe9)\n    return await OrderReadModel.findOne({\n      where: { orderId: query.orderId }\n    });\n    \n    // Retourne directement:\n    // {\n    //   orderId: '123',\n    //   userName: 'John Doe',     // D\xe9normalis\xe9\n    //   userEmail: 'john@...',    // D\xe9normalis\xe9\n    //   items: [                   // Pr\xe9-joint\xe9\n    //     { productName: '...', price: ... }\n    //   ],\n    //   totalAmount: 150\n    // }\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"synchronisation-read-model",children:"Synchronisation Read Model"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Projector : \xe9coute les \xe9v\xe9nements et met \xe0 jour Read DB\neventBus.subscribe('OrderCreated', async (event) => {\n  const order = await Order.findByPk(event.orderId, {\n    include: [User, OrderItems]\n  });\n  \n  // Cr\xe9er vue d\xe9normalis\xe9e\n  await OrderReadModel.create({\n    orderId: order.id,\n    userName: order.user.name,\n    userEmail: order.user.email,\n    items: order.items.map(item => ({\n      productName: item.product.name,\n      quantity: item.quantity,\n      price: item.price\n    })),\n    totalAmount: order.totalAmount,\n    status: order.status\n  });\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-impl\xe9mentation",children:"\ud83d\udcbb Impl\xe9mentation"}),"\n",(0,s.jsx)(n.h3,{id:"api-rest",children:"API REST"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// ===== COMMANDS =====\nrouter.post('/orders', async (req, res) => {\n  const command = new CreateOrderCommand(\n    req.user.id,\n    req.body.items\n  );\n  \n  const orderId = await commandBus.dispatch(command);\n  \n  res.status(202).json({ orderId }); // 202 Accepted\n});\n\n// ===== QUERIES =====\nrouter.get('/orders/:id', async (req, res) => {\n  const query = new GetOrderDetailsQuery(req.params.id);\n  \n  const order = await queryBus.dispatch(query);\n  \n  res.json(order);\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"technologies-read-db",children:"Technologies Read DB"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Use Case"}),(0,s.jsx)(n.th,{children:"Write DB"}),(0,s.jsx)(n.th,{children:"Read DB"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Simple"})}),(0,s.jsx)(n.td,{children:"PostgreSQL"}),(0,s.jsx)(n.td,{children:"PostgreSQL (vues mat\xe9rialis\xe9es)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Analytics"})}),(0,s.jsx)(n.td,{children:"PostgreSQL"}),(0,s.jsx)(n.td,{children:"Elasticsearch"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"High read load"})}),(0,s.jsx)(n.td,{children:"PostgreSQL"}),(0,s.jsx)(n.td,{children:"Redis (cache)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Complex queries"})}),(0,s.jsx)(n.td,{children:"PostgreSQL"}),(0,s.jsx)(n.td,{children:"PostgreSQL (sch\xe9ma d\xe9normalis\xe9)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Full-text search"})}),(0,s.jsx)(n.td,{children:"MongoDB"}),(0,s.jsx)(n.td,{children:"Elasticsearch"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"-eventual-consistency",children:"\ud83d\udd04 Eventual Consistency"}),"\n",(0,s.jsxs)(n.p,{children:["Le Read Model est ",(0,s.jsx)(n.strong,{children:"\xe9ventuellement coh\xe9rent"})," avec le Write Model."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// T0: Command ex\xe9cut\xe9e\nPOST /orders \u2192 { orderId: '123' }\n\n// T1: \xc9v\xe9nement publi\xe9 et trait\xe9 (~10-100ms)\nEvent: OrderCreated\n\n// T2: Read Model mis \xe0 jour\nGET /orders/123 \u2192 { order details }\n\n// \u26a0\ufe0f Entre T0 et T2 : Read Model pas encore \xe0 jour\n"})}),"\n",(0,s.jsx)(n.h3,{id:"g\xe9rer-lui",children:"G\xe9rer l'UI"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Option 1: Optimistic UI\n// Afficher imm\xe9diatement avec donn\xe9es de la commande\nconst optimisticOrder = {\n  id: orderId,\n  status: 'PENDING',\n  items: command.items\n};\n\n// Option 2: Polling\nasync function waitForOrder(orderId) {\n  for (let i = 0; i < 10; i++) {\n    const order = await getOrder(orderId);\n    if (order) return order;\n    await sleep(100);\n  }\n  throw new Error('Order not found');\n}\n\n// Option 3: WebSocket notification\neventBus.subscribe('OrderCreated', (event) => {\n  websocket.send({ type: 'OrderReady', orderId: event.orderId });\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-niveaux-de-cqrs",children:"\ud83c\udfa8 Niveaux de CQRS"}),"\n",(0,s.jsx)(n.h3,{id:"niveau-1--s\xe9paration-logique",children:"Niveau 1 : S\xe9paration logique"}),"\n",(0,s.jsx)(n.p,{children:"M\xeame BDD, mod\xe8les diff\xe9rents"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Write Model (ORM)\nclass Order {\n  id: number;\n  userId: number;\n  items: OrderItem[];\n}\n\n// Read Model (DTO simple)\ninterface OrderDTO {\n  orderId: number;\n  userName: string;\n  totalAmount: number;\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"niveau-2--s\xe9paration-physique",children:"Niveau 2 : S\xe9paration physique"}),"\n",(0,s.jsx)(n.p,{children:"BDD s\xe9par\xe9es, synchronisation \xe9v\xe9nementielle"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Write DB: PostgreSQL normalis\xe9\n// Read DB: PostgreSQL d\xe9normalis\xe9\n// Sync: CDC (Change Data Capture) via Debezium\n"})}),"\n",(0,s.jsx)(n.h3,{id:"niveau-3--technologies-diff\xe9rentes",children:"Niveau 3 : Technologies diff\xe9rentes"}),"\n",(0,s.jsx)(n.p,{children:"Optimisation maximale"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Write: PostgreSQL (ACID)\n// Read: Elasticsearch (full-text search)\n// Sync: Kafka events\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-avantages",children:"\u2705 Avantages"}),"\n",(0,s.jsx)(n.h3,{id:"1-performance",children:"1. Performance"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Lecture"})," : donn\xe9es pr\xe9-calcul\xe9es, pas de JOIN"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\xc9criture"})," : pas de contraintes de lecture"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-scalabilit\xe9",children:"2. Scalabilit\xe9"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Scaler Read/Write ind\xe9pendamment"}),"\n",(0,s.jsx)(n.li,{children:"Read replicas multiples"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-optimisation-cibl\xe9e",children:"3. Optimisation cibl\xe9e"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Indexes adapt\xe9s par usage"}),"\n",(0,s.jsx)(n.li,{children:"Caching agressif sur Read"}),"\n",(0,s.jsx)(n.li,{children:"Sharding diff\xe9rent Read/Write"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"4-flexibilit\xe9",children:"4. Flexibilit\xe9"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Plusieurs Read Models pour diff\xe9rents besoins"}),"\n",(0,s.jsx)(n.li,{children:"Migration technologique facilit\xe9e"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-inconv\xe9nients",children:"\u26a0\ufe0f Inconv\xe9nients"}),"\n",(0,s.jsx)(n.h3,{id:"1-complexit\xe9",children:"1. Complexit\xe9"}),"\n",(0,s.jsx)(n.p,{children:"Code plus complexe que CRUD simple"}),"\n",(0,s.jsx)(n.h3,{id:"2-eventual-consistency",children:"2. Eventual Consistency"}),"\n",(0,s.jsx)(n.p,{children:"UI doit g\xe9rer le d\xe9lai de synchronisation"}),"\n",(0,s.jsx)(n.h3,{id:"3-duplication-de-donn\xe9es",children:"3. Duplication de donn\xe9es"}),"\n",(0,s.jsx)(n.p,{children:"Plus de stockage n\xe9cessaire"}),"\n",(0,s.jsx)(n.h3,{id:"4-synchronisation",children:"4. Synchronisation"}),"\n",(0,s.jsx)(n.p,{children:"Erreurs de sync \xe0 g\xe9rer"}),"\n",(0,s.jsx)(n.h2,{id:"\ufe0f-frameworks",children:"\ud83d\udee0\ufe0f Frameworks"}),"\n",(0,s.jsx)(n.h3,{id:"axon-framework-java",children:"Axon Framework (Java)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"// Command\n@CommandHandler\npublic OrderId handle(CreateOrderCommand command) {\n    OrderId orderId = new OrderId();\n    apply(new OrderCreatedEvent(orderId, command.getItems()));\n    return orderId;\n}\n\n// Query\n@QueryHandler\npublic OrderDetails handle(GetOrderDetailsQuery query) {\n    return orderReadRepository.findById(query.getOrderId());\n}\n\n// Projection (mise \xe0 jour Read Model)\n@EventHandler\npublic void on(OrderCreatedEvent event) {\n    OrderDetails details = new OrderDetails(event.getOrderId());\n    orderReadRepository.save(details);\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"mediatr-net",children:"MediatR (.NET)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"// Command\npublic class CreateOrderCommand : IRequest<Guid>\n{\n    public List<OrderItem> Items { get; set; }\n}\n\npublic class CreateOrderHandler : IRequestHandler<CreateOrderCommand, Guid>\n{\n    public async Task<Guid> Handle(CreateOrderCommand request, ...)\n    {\n        var order = new Order(request.Items);\n        await _repository.SaveAsync(order);\n        return order.Id;\n    }\n}\n\n// Query\npublic class GetOrderQuery : IRequest<OrderDto>\n{\n    public Guid OrderId { get; set; }\n}\n\npublic class GetOrderHandler : IRequestHandler<GetOrderQuery, OrderDto>\n{\n    public async Task<OrderDto> Handle(GetOrderQuery request, ...)\n    {\n        return await _readRepository.GetOrderAsync(request.OrderId);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-quand-utiliser-cqrs-",children:"\ud83d\udcca Quand utiliser CQRS ?"}),"\n",(0,s.jsx)(n.h3,{id:"-cas-appropri\xe9s",children:"\u2705 Cas appropri\xe9s"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Charge de lecture >> \xe9criture (ratio 100:1 typique)"}),"\n",(0,s.jsx)(n.li,{children:"Besoins de performance critiques"}),"\n",(0,s.jsx)(n.li,{children:"Requ\xeates complexes avec agr\xe9gations"}),"\n",(0,s.jsx)(n.li,{children:"Mod\xe8les de lecture multiples"}),"\n",(0,s.jsx)(n.li,{children:"Domain-Driven Design"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"-\xe9viter-si",children:"\u274c \xc9viter si"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"CRUD simple"}),"\n",(0,s.jsx)(n.li,{children:"Charge \xe9quilibr\xe9e lecture/\xe9criture"}),"\n",(0,s.jsx)(n.li,{children:"\xc9quipe sans exp\xe9rience"}),"\n",(0,s.jsx)(n.li,{children:"Coh\xe9rence imm\xe9diate obligatoire"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"-bonnes-pratiques",children:"\u2705 Bonnes pratiques"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Commencer simple"})," : CQRS logique avant physique"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Monitoring de sync"})," : latence Read Model"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Versioning"})," : g\xe9rer \xe9volution des Read Models"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Idempotence"})," : projections rejouables"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Tests"})," : v\xe9rifier coh\xe9rence finale"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Documentation"})," : expliquer l'eventual consistency"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"-tests",children:"\ud83e\uddea Tests"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"describe('CQRS Order Flow', () => {\n  it('should eventually sync Read Model', async () => {\n    // Command\n    const orderId = await commandBus.dispatch(\n      new CreateOrderCommand(userId, items)\n    );\n    \n    // Wait for projection\n    await waitFor(() => \n      queryBus.dispatch(new GetOrderQuery(orderId))\n    );\n    \n    // Verify Read Model\n    const order = await queryBus.dispatch(\n      new GetOrderQuery(orderId)\n    );\n    expect(order.totalAmount).toBe(150);\n  });\n});\n"})}),"\n",(0,s.jsx)(n.h2,{id:"ressources",children:"Ressources"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://martinfowler.com/bliki/CQRS.html",children:"CQRS - Martin Fowler"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/architecture/patterns/cqrs",children:"Microsoft CQRS Pattern"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://cqrs.files.wordpress.com/2010/11/cqrs_documents.pdf",children:"Greg Young - CQRS Documents"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>l});var i=r(6540);const s={},d=i.createContext(s);function t(e){const n=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(d.Provider,{value:n},e.children)}}}]);