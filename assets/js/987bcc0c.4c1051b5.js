"use strict";(globalThis.webpackChunkdocusaurus_poc=globalThis.webpackChunkdocusaurus_poc||[]).push([[3790],{6617:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"security/owasp/owasp-top-10","title":"\ud83d\udee1\ufe0f OWASP Top 10 - S\xe9curit\xe9 Applicative","description":"Guide complet pour s\xe9curiser vos applications Java, Drupal et Angular contre les vuln\xe9rabilit\xe9s OWASP Top 10 (2021).","source":"@site/docs/security/owasp/owasp-top-10.md","sourceDirName":"security/owasp","slug":"/security/owasp/owasp-top-10","permalink":"/docs/security/owasp/owasp-top-10","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/security/owasp/owasp-top-10.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"docs","previous":{"title":"Basic Auth","permalink":"/docs/security/authentification-autorisation/basic-auth"},"next":{"title":"Outils","permalink":"/docs/tools/"}}');var i=t(4848),s=t(8453);const a={sidebar_position:1},o="\ud83d\udee1\ufe0f OWASP Top 10 - S\xe9curit\xe9 Applicative",c={},l=[{value:"\ud83c\udfaf OWASP Top 10 - Vue d&#39;ensemble",id:"-owasp-top-10---vue-densemble",level:2},{value:"\ud83d\udd34 A01 - Broken Access Control",id:"-a01---broken-access-control",level:2},{value:"Description",id:"description",level:3},{value:"Exemples d&#39;attaques",id:"exemples-dattaques",level:3},{value:"\u2615 Protection Java/Spring Boot",id:"-protection-javaspring-boot",level:3},{value:"\ud83d\udd37 Protection Drupal",id:"-protection-drupal",level:3},{value:"\ud83c\udd70\ufe0f Protection Angular",id:"\ud83c\udd70\ufe0f-protection-angular",level:3},{value:"\ud83d\udd34 A02 - Cryptographic Failures",id:"-a02---cryptographic-failures",level:2},{value:"\u2615 Java - Chiffrement s\xe9curis\xe9",id:"-java---chiffrement-s\xe9curis\xe9",level:3},{value:"\ud83d\udd37 Drupal - Encryption",id:"-drupal---encryption",level:3},{value:"\ud83d\udd34 A03 - Injection (SQL, XSS, Command)",id:"-a03---injection-sql-xss-command",level:2},{value:"\u2615 Java - Prevention Injection",id:"-java---prevention-injection",level:3},{value:"\ud83d\udd37 Drupal - Prevention Injection",id:"-drupal---prevention-injection",level:3},{value:"\ud83c\udd70\ufe0f Angular - Prevention XSS",id:"\ud83c\udd70\ufe0f-angular---prevention-xss",level:3},{value:"\ud83d\udd34 A04 - Insecure Design",id:"-a04---insecure-design",level:2},{value:"Rate Limiting",id:"rate-limiting",level:3},{value:"\ud83d\udd34 A05 - Security Misconfiguration",id:"-a05---security-misconfiguration",level:2},{value:"Security Headers",id:"security-headers",level:3},{value:"Nginx Configuration S\xe9curis\xe9e",id:"nginx-configuration-s\xe9curis\xe9e",level:3}];function u(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\ufe0f-owasp-top-10---s\xe9curit\xe9-applicative",children:"\ud83d\udee1\ufe0f OWASP Top 10 - S\xe9curit\xe9 Applicative"})}),"\n",(0,i.jsx)(n.p,{children:"Guide complet pour s\xe9curiser vos applications Java, Drupal et Angular contre les vuln\xe9rabilit\xe9s OWASP Top 10 (2021)."}),"\n",(0,i.jsx)(n.h2,{id:"-owasp-top-10---vue-densemble",children:"\ud83c\udfaf OWASP Top 10 - Vue d'ensemble"}),"\n",(0,i.jsx)(n.mermaid,{value:'graph TB\n    subgraph "OWASP Top 10 - 2021"\n        A01[A01 - Broken Access Control]\n        A02[A02 - Cryptographic Failures]\n        A03[A03 - Injection]\n        A04[A04 - Insecure Design]\n        A05[A05 - Security Misconfiguration]\n        A06[A06 - Vulnerable Components]\n        A07[A07 - Authentication Failures]\n        A08[A08 - Software/Data Integrity]\n        A09[A09 - Logging/Monitoring Failures]\n        A10[A10 - SSRF]\n    end\n    \n    subgraph "Protection Stack"\n        WAF[\ud83d\udd25 WAF]\n        GATEWAY[\ud83d\udeaa API Gateway]\n        AUTH[\ud83d\udd10 OAuth2/OIDC]\n        VAULT[\ud83d\udd12 Vault]\n        SAST[\ud83d\udcca SonarQube]\n        DAST[\ud83d\udd0d OWASP ZAP]\n        SCA[\ud83d\udce6 Dependency Check]\n    end\n    \n    A01 --\x3e AUTH\n    A02 --\x3e VAULT\n    A03 --\x3e SAST\n    A04 --\x3e SAST\n    A05 --\x3e SAST\n    A06 --\x3e SCA\n    A07 --\x3e AUTH\n    A08 --\x3e SAST\n    A09 --\x3e SAST\n    A10 --\x3e WAF\n    \n    AUTH --\x3e GATEWAY\n    VAULT --\x3e GATEWAY\n    GATEWAY --\x3e WAF\n    \n    style A01 fill:#dc3545,color:#fff\n    style A02 fill:#dc3545,color:#fff\n    style A03 fill:#dc3545,color:#fff'}),"\n",(0,i.jsx)(n.h2,{id:"-a01---broken-access-control",children:"\ud83d\udd34 A01 - Broken Access Control"}),"\n",(0,i.jsx)(n.h3,{id:"description",children:"Description"}),"\n",(0,i.jsx)(n.p,{children:"\xc9chec dans l'application des restrictions d'acc\xe8s permettant aux utilisateurs d'acc\xe9der \xe0 des ressources non autoris\xe9es."}),"\n",(0,i.jsx)(n.h3,{id:"exemples-dattaques",children:"Exemples d'attaques"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Modification d'URL pour acc\xe9der \xe0 d'autres comptes"}),"\n",(0,i.jsx)(n.li,{children:"\xc9l\xe9vation de privil\xe8ges"}),"\n",(0,i.jsx)(n.li,{children:"CORS mal configur\xe9"}),"\n",(0,i.jsx)(n.li,{children:"IDOR (Insecure Direct Object References)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-protection-javaspring-boot",children:"\u2615 Protection Java/Spring Boot"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// SecurityConfig.java\n@Configuration\n@EnableWebSecurity\n@EnableMethodSecurity(prePostEnabled = true)\npublic class SecurityConfig {\n    \n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http\n            .authorizeHttpRequests(auth -> auth\n                // Public endpoints\n                .requestMatchers("/api/public/**").permitAll()\n                .requestMatchers("/health", "/metrics").permitAll()\n                \n                // Admin only\n                .requestMatchers("/api/admin/**").hasRole("ADMIN")\n                \n                // User endpoints\n                .requestMatchers("/api/users/**").hasAnyRole("USER", "ADMIN")\n                \n                // Authenticated\n                .anyRequest().authenticated()\n            )\n            .csrf(csrf -> csrf\n                .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse())\n            )\n            .sessionManagement(session -> session\n                .sessionCreationPolicy(SessionCreationPolicy.STATELESS)\n            )\n            .oauth2ResourceServer(oauth2 -> oauth2\n                .jwt(jwt -> jwt.jwtAuthenticationConverter(jwtAuthenticationConverter()))\n            );\n        \n        return http.build();\n    }\n    \n    // Method-level security\n    @Service\n    public class UserService {\n        \n        @PreAuthorize("hasRole(\'ADMIN\') or #userId == authentication.principal.id")\n        public User getUser(Long userId) {\n            return userRepository.findById(userId)\n                .orElseThrow(() -> new ResourceNotFoundException("User not found"));\n        }\n        \n        @PreAuthorize("@userSecurity.canAccessResource(#resourceId, authentication)")\n        public Resource getResource(Long resourceId) {\n            return resourceRepository.findById(resourceId)\n                .orElseThrow(() -> new ResourceNotFoundException("Resource not found"));\n        }\n    }\n    \n    // Custom security expression\n    @Component("userSecurity")\n    public class UserSecurityService {\n        \n        public boolean canAccessResource(Long resourceId, Authentication auth) {\n            UserDetails user = (UserDetails) auth.getPrincipal();\n            Resource resource = resourceRepository.findById(resourceId).orElse(null);\n            \n            if (resource == null) return false;\n            \n            // Check ownership\n            if (resource.getOwnerId().equals(user.getId())) {\n                return true;\n            }\n            \n            // Check team membership\n            return resource.getTeam().getMembers().contains(user);\n        }\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"-protection-drupal",children:"\ud83d\udd37 Protection Drupal"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"<?php\n// custom_module.permissions.yml\npermissions:\n  'access custom content':\n    title: 'Access custom content'\n    description: 'Permission to view custom content'\n  'administer custom content':\n    title: 'Administer custom content'\n    description: 'Full administrative access'\n\n// CustomController.php\nnamespace Drupal\\custom_module\\Controller;\n\nuse Drupal\\Core\\Access\\AccessResult;\nuse Drupal\\Core\\Controller\\ControllerBase;\nuse Drupal\\node\\NodeInterface;\n\nclass CustomController extends ControllerBase {\n  \n  /**\n   * Access callback for custom route.\n   */\n  public function access(NodeInterface $node) {\n    $current_user = \\Drupal::currentUser();\n    \n    // Check basic permission\n    if (!$current_user->hasPermission('access custom content')) {\n      return AccessResult::forbidden();\n    }\n    \n    // Check ownership\n    if ($node->getOwnerId() == $current_user->id()) {\n      return AccessResult::allowed()->cachePerUser()->addCacheableDependency($node);\n    }\n    \n    // Check team membership\n    if ($node->hasField('field_team')) {\n      $team_members = $node->get('field_team')->referencedEntities();\n      foreach ($team_members as $member) {\n        if ($member->id() == $current_user->id()) {\n          return AccessResult::allowed()->cachePerUser()->addCacheableDependency($node);\n        }\n      }\n    }\n    \n    return AccessResult::forbidden();\n  }\n}\n\n// services.yml\nservices:\n  custom_module.access_checker:\n    class: Drupal\\custom_module\\Access\\CustomAccessChecker\n    tags:\n      - { name: access_check, applies_to: _custom_access }\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\ud83c\udd70\ufe0f-protection-angular",children:"\ud83c\udd70\ufe0f Protection Angular"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// auth.guard.ts\n@Injectable()\nexport class AuthGuard implements CanActivate {\n  constructor(\n    private authService: AuthService,\n    private router: Router\n  ) {}\n  \n  canActivate(\n    route: ActivatedRouteSnapshot,\n    state: RouterStateSnapshot\n  ): Observable<boolean> {\n    return this.authService.getCurrentUser().pipe(\n      map(user => {\n        // Check authentication\n        if (!user) {\n          this.router.navigate(['/login']);\n          return false;\n        }\n        \n        // Check roles\n        const requiredRoles = route.data['roles'] as string[];\n        if (requiredRoles && !this.hasRequiredRoles(user, requiredRoles)) {\n          this.router.navigate(['/forbidden']);\n          return false;\n        }\n        \n        // Check ownership for resource routes\n        if (route.data['checkOwnership']) {\n          const resourceId = route.params['id'];\n          return this.authService.canAccessResource(resourceId, user.id);\n        }\n        \n        return true;\n      }),\n      catchError(() => {\n        this.router.navigate(['/login']);\n        return of(false);\n      })\n    );\n  }\n  \n  private hasRequiredRoles(user: User, roles: string[]): boolean {\n    return roles.some(role => user.roles.includes(role));\n  }\n}\n\n// app-routing.module.ts\nconst routes: Routes = [\n  {\n    path: 'admin',\n    canActivate: [AuthGuard],\n    data: { roles: ['ADMIN'] },\n    loadChildren: () => import('./admin/admin.module').then(m => m.AdminModule)\n  },\n  {\n    path: 'users/:id',\n    canActivate: [AuthGuard],\n    data: { checkOwnership: true },\n    component: UserDetailComponent\n  }\n];\n\n// HTTP Interceptor for CORS\n@Injectable()\nexport class SecurityInterceptor implements HttpInterceptor {\n  intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n    // Add security headers\n    const secureReq = req.clone({\n      setHeaders: {\n        'X-Requested-With': 'XMLHttpRequest',\n        'X-Frame-Options': 'DENY',\n        'X-Content-Type-Options': 'nosniff'\n      }\n    });\n    \n    return next.handle(secureReq);\n  }\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"-a02---cryptographic-failures",children:"\ud83d\udd34 A02 - Cryptographic Failures"}),"\n",(0,i.jsx)(n.h3,{id:"-java---chiffrement-s\xe9curis\xe9",children:"\u2615 Java - Chiffrement s\xe9curis\xe9"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@Configuration\npublic class CryptoConfig {\n    \n    // Use strong algorithms\n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder(12); // Cost factor 12\n    }\n    \n    // AES-GCM for data encryption\n    @Service\n    public class EncryptionService {\n        \n        private static final String ALGORITHM = "AES/GCM/NoPadding";\n        private static final int TAG_LENGTH_BIT = 128;\n        private static final int IV_LENGTH_BYTE = 12;\n        \n        @Value("${encryption.key}")\n        private String base64Key;\n        \n        public String encrypt(String plaintext) throws Exception {\n            SecretKey key = new SecretKeySpec(\n                Base64.getDecoder().decode(base64Key), \n                "AES"\n            );\n            \n            // Generate random IV\n            byte[] iv = new byte[IV_LENGTH_BYTE];\n            new SecureRandom().nextBytes(iv);\n            \n            Cipher cipher = Cipher.getInstance(ALGORITHM);\n            GCMParameterSpec parameterSpec = new GCMParameterSpec(TAG_LENGTH_BIT, iv);\n            cipher.init(Cipher.ENCRYPT_MODE, key, parameterSpec);\n            \n            byte[] cipherText = cipher.doFinal(plaintext.getBytes(StandardCharsets.UTF_8));\n            \n            // Prepend IV to ciphertext\n            byte[] encrypted = new byte[IV_LENGTH_BYTE + cipherText.length];\n            System.arraycopy(iv, 0, encrypted, 0, IV_LENGTH_BYTE);\n            System.arraycopy(cipherText, 0, encrypted, IV_LENGTH_BYTE, cipherText.length);\n            \n            return Base64.getEncoder().encodeToString(encrypted);\n        }\n        \n        public String decrypt(String encrypted) throws Exception {\n            byte[] decoded = Base64.getDecoder().decode(encrypted);\n            \n            // Extract IV\n            byte[] iv = new byte[IV_LENGTH_BYTE];\n            System.arraycopy(decoded, 0, iv, 0, IV_LENGTH_BYTE);\n            \n            // Extract ciphertext\n            byte[] cipherText = new byte[decoded.length - IV_LENGTH_BYTE];\n            System.arraycopy(decoded, IV_LENGTH_BYTE, cipherText, 0, cipherText.length);\n            \n            SecretKey key = new SecretKeySpec(\n                Base64.getDecoder().decode(base64Key), \n                "AES"\n            );\n            \n            Cipher cipher = Cipher.getInstance(ALGORITHM);\n            GCMParameterSpec parameterSpec = new GCMParameterSpec(TAG_LENGTH_BIT, iv);\n            cipher.init(Cipher.DECRYPT_MODE, key, parameterSpec);\n            \n            byte[] plaintext = cipher.doFinal(cipherText);\n            return new String(plaintext, StandardCharsets.UTF_8);\n        }\n    }\n    \n    // TLS configuration\n    @Bean\n    public TomcatServletWebServerFactory servletContainer() {\n        TomcatServletWebServerFactory tomcat = new TomcatServletWebServerFactory() {\n            @Override\n            protected void postProcessContext(Context context) {\n                SecurityConstraint constraint = new SecurityConstraint();\n                constraint.setUserConstraint("CONFIDENTIAL");\n                \n                SecurityCollection collection = new SecurityCollection();\n                collection.addPattern("/*");\n                constraint.addCollection(collection);\n                \n                context.addConstraint(constraint);\n            }\n        };\n        tomcat.addAdditionalTomcatConnectors(redirectConnector());\n        return tomcat;\n    }\n    \n    private Connector redirectConnector() {\n        Connector connector = new Connector("org.apache.coyote.http11.Http11NioProtocol");\n        connector.setScheme("http");\n        connector.setPort(8080);\n        connector.setSecure(false);\n        connector.setRedirectPort(8443);\n        return connector;\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"-drupal---encryption",children:"\ud83d\udd37 Drupal - Encryption"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"<?php\n// settings.php\n$settings['hash_salt'] = 'CHANGE_THIS_TO_RANDOM_STRING';\n\n// Use Encrypt module\nuse Drupal\\encrypt\\EncryptionProfileManager;\nuse Drupal\\encrypt\\Entity\\EncryptionProfile;\n\n// Encrypt sensitive data\n$encryption_profile = EncryptionProfile::load('my_encryption_profile');\n$encrypted = \\Drupal::service('encryption')->encrypt($plaintext, $encryption_profile);\n\n// Password hashing\nuse Drupal\\Core\\Password\\PasswordInterface;\n\n$password_hasher = \\Drupal::service('password');\n$hashed = $password_hasher->hash($password);\n$is_valid = $password_hasher->check($password, $hashed);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"-a03---injection-sql-xss-command",children:"\ud83d\udd34 A03 - Injection (SQL, XSS, Command)"}),"\n",(0,i.jsx)(n.h3,{id:"-java---prevention-injection",children:"\u2615 Java - Prevention Injection"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// SQL Injection Prevention\n@Repository\npublic interface UserRepository extends JpaRepository<User, Long> {\n    \n    // \u2705 GOOD - Parameterized query\n    @Query("SELECT u FROM User u WHERE u.email = :email")\n    Optional<User> findByEmail(@Param("email") String email);\n    \n    // \u274c BAD - String concatenation\n    // @Query("SELECT u FROM User u WHERE u.email = \'" + email + "\'")\n    \n    // \u2705 GOOD - Native query with parameters\n    @Query(value = "SELECT * FROM users WHERE status = ?1 AND role = ?2", nativeQuery = true)\n    List<User> findByStatusAndRole(String status, String role);\n}\n\n// XSS Prevention\n@Service\npublic class HtmlSanitizerService {\n    \n    private final PolicyFactory policy;\n    \n    public HtmlSanitizerService() {\n        this.policy = Sanitizers.FORMATTING\n            .and(Sanitizers.LINKS)\n            .and(Sanitizers.BLOCKS);\n    }\n    \n    public String sanitize(String html) {\n        return policy.sanitize(html);\n    }\n}\n\n// Command Injection Prevention\n@Service\npublic class FileService {\n    \n    // \u2705 GOOD - Use ProcessBuilder with List\n    public void executeCommand(String filename) throws IOException {\n        // Whitelist validation\n        if (!filename.matches("[a-zA-Z0-9._-]+")) {\n            throw new IllegalArgumentException("Invalid filename");\n        }\n        \n        ProcessBuilder pb = new ProcessBuilder(\n            "convert",\n            filename,\n            filename + ".pdf"\n        );\n        pb.directory(new File("/tmp"));\n        Process process = pb.start();\n    }\n    \n    // \u274c BAD - Runtime.exec with string concatenation\n    // Runtime.getRuntime().exec("convert " + filename + " output.pdf");\n}\n\n// LDAP Injection Prevention\n@Service\npublic class LdapService {\n    \n    public List<User> searchUsers(String username) {\n        // Escape LDAP special characters\n        String escapedUsername = LdapEncoder.filterEncode(username);\n        \n        LdapQuery query = LdapQueryBuilder.query()\n            .where("uid").is(escapedUsername);\n        \n        return ldapTemplate.search(query, new UserAttributesMapper());\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"-drupal---prevention-injection",children:"\ud83d\udd37 Drupal - Prevention Injection"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",children:"<?php\n// SQL Injection Prevention\nuse Drupal\\Core\\Database\\Database;\n\n// \u2705 GOOD - Parameterized query\n$connection = Database::getConnection();\n$query = $connection->select('users_field_data', 'u')\n  ->fields('u', ['uid', 'name', 'mail'])\n  ->condition('u.mail', $email, '=')\n  ->condition('u.status', 1, '=');\n$results = $query->execute()->fetchAll();\n\n// \u2705 GOOD - Dynamic query with placeholders\n$query = $connection->query('SELECT * FROM {users} WHERE mail = :email', [\n  ':email' => $email\n]);\n\n// \u274c BAD - String concatenation\n// $query = \"SELECT * FROM users WHERE mail = '$email'\";\n\n// XSS Prevention\nuse Drupal\\Component\\Utility\\Html;\nuse Drupal\\Component\\Utility\\Xss;\n\n// Filter dangerous tags\n$safe_string = Xss::filter($user_input);\n\n// Escape HTML\n$escaped = Html::escape($user_input);\n\n// In templates (Twig auto-escapes)\n// {{ user_input }}  - Auto-escaped\n// {{ user_input|raw }}  - NOT escaped (dangerous)\n\n// Command Injection Prevention\nuse Symfony\\Component\\Process\\Process;\n\n// \u2705 GOOD - Use Process with array\n$process = new Process([\n  'convert',\n  $filename,\n  $output_filename\n]);\n$process->run();\n\n// \u274c BAD - Shell execution\n// exec(\"convert $filename $output_filename\");\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\ud83c\udd70\ufe0f-angular---prevention-xss",children:"\ud83c\udd70\ufe0f Angular - Prevention XSS"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// XSS Prevention in Angular\nimport { DomSanitizer, SafeHtml } from '@angular/platform-browser';\n\n@Component({\n  selector: 'app-content',\n  template: `\n    \x3c!-- \u2705 GOOD - Angular auto-escapes --\x3e\n    <div>{{ userInput }}</div>\n    \n    \x3c!-- \u2705 GOOD - Sanitized HTML --\x3e\n    <div [innerHTML]=\"sanitizedHtml\"></div>\n    \n    \x3c!-- \u274c BAD - Bypass security --\x3e\n    \x3c!-- <div [innerHTML]=\"unsafeHtml\"></div> --\x3e\n  `\n})\nexport class ContentComponent {\n  userInput: string;\n  sanitizedHtml: SafeHtml;\n  \n  constructor(private sanitizer: DomSanitizer) {}\n  \n  ngOnInit() {\n    // Sanitize HTML\n    this.sanitizedHtml = this.sanitizer.sanitize(\n      SecurityContext.HTML,\n      this.userInput\n    );\n  }\n  \n  // Custom sanitizer\n  sanitizeInput(input: string): string {\n    return input\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&#x27;')\n      .replace(/\\//g, '&#x2F;');\n  }\n}\n\n// CSP Headers\n// index.html\n<meta http-equiv=\"Content-Security-Policy\" \n      content=\"default-src 'self'; \n               script-src 'self'; \n               style-src 'self' 'unsafe-inline'; \n               img-src 'self' data: https:;\n               font-src 'self' data:;\">\n"})}),"\n",(0,i.jsx)(n.h2,{id:"-a04---insecure-design",children:"\ud83d\udd34 A04 - Insecure Design"}),"\n",(0,i.jsx)(n.mermaid,{value:'graph LR\n    subgraph "Threat Modeling"\n        TM1[Identify Assets]\n        TM2[Identify Threats]\n        TM3[Assess Risks]\n        TM4[Define Mitigations]\n    end\n    \n    TM1 --\x3e TM2\n    TM2 --\x3e TM3\n    TM3 --\x3e TM4\n    \n    subgraph "Secure Design Patterns"\n        PATTERN1[Rate Limiting]\n        PATTERN2[Circuit Breaker]\n        PATTERN3[Input Validation]\n        PATTERN4[Least Privilege]\n    end\n    \n    TM4 --\x3e PATTERN1\n    TM4 --\x3e PATTERN2\n    TM4 --\x3e PATTERN3\n    TM4 --\x3e PATTERN4'}),"\n",(0,i.jsx)(n.h3,{id:"rate-limiting",children:"Rate Limiting"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// Java - Rate Limiting with Bucket4j\n@Configuration\npublic class RateLimitConfig {\n    \n    @Bean\n    public Bucket createBucket() {\n        Bandwidth limit = Bandwidth.classic(100, Refill.intervally(100, Duration.ofMinutes(1)));\n        return Bucket4j.builder()\n            .addLimit(limit)\n            .build();\n    }\n}\n\n@RestController\npublic class ApiController {\n    \n    @Autowired\n    private Bucket bucket;\n    \n    @GetMapping("/api/resource")\n    public ResponseEntity<?> getResource() {\n        if (bucket.tryConsume(1)) {\n            return ResponseEntity.ok(resource);\n        }\n        return ResponseEntity.status(HttpStatus.TOO_MANY_REQUESTS)\n            .body("Rate limit exceeded");\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"-a05---security-misconfiguration",children:"\ud83d\udd34 A05 - Security Misconfiguration"}),"\n",(0,i.jsx)(n.h3,{id:"security-headers",children:"Security Headers"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"// Java/Spring - Security Headers\n@Configuration\npublic class SecurityHeadersConfig {\n    \n    @Bean\n    public SecurityFilterChain configure(HttpSecurity http) throws Exception {\n        http.headers(headers -> headers\n            .contentSecurityPolicy(\"default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'\")\n            .referrerPolicy(ReferrerPolicyHeaderWriter.ReferrerPolicy.STRICT_ORIGIN_WHEN_CROSS_ORIGIN)\n            .permissionsPolicy(policy -> policy.policy(\"geolocation=(), microphone=(), camera=()\"))\n            .frameOptions().deny()\n            .xssProtection().block(true)\n            .contentTypeOptions().disable()\n            .httpStrictTransportSecurity()\n                .includeSubDomains(true)\n                .maxAgeInSeconds(31536000)\n        );\n        \n        return http.build();\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"nginx-configuration-s\xe9curis\xe9e",children:"Nginx Configuration S\xe9curis\xe9e"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-nginx",children:'# nginx.conf\nserver {\n    listen 443 ssl http2;\n    server_name example.com;\n    \n    # SSL Configuration\n    ssl_certificate /etc/nginx/ssl/cert.pem;\n    ssl_certificate_key /etc/nginx/ssl/key.pem;\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers HIGH:!aNULL:!MD5;\n    ssl_prefer_server_ciphers on;\n    \n    # Security Headers\n    add_header X-Frame-Options "DENY" always;\n    add_header X-Content-Type-Options "nosniff" always;\n    add_header X-XSS-Protection "1; mode=block" always;\n    add_header Referrer-Policy "strict-origin-when-cross-origin" always;\n    add_header Content-Security-Policy "default-src \'self\'; script-src \'self\' \'unsafe-inline\'; style-src \'self\' \'unsafe-inline\';" always;\n    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;\n    add_header Permissions-Policy "geolocation=(), microphone=(), camera=()" always;\n    \n    # Hide version\n    server_tokens off;\n    \n    # Limit request size\n    client_max_body_size 10M;\n    \n    # Timeouts\n    client_body_timeout 12;\n    client_header_timeout 12;\n    keepalive_timeout 15;\n    send_timeout 10;\n    \n    # Rate limiting\n    limit_req_zone $binary_remote_addr zone=api_limit:10m rate=10r/s;\n    \n    location /api/ {\n        limit_req zone=api_limit burst=20 nodelay;\n        proxy_pass http://backend;\n    }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Suite dans le prochain message avec A06-A10..."})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var r=t(6540);const i={},s=r.createContext(i);function a(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);